<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCTuner Pro v6</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        *{box-sizing:border-box;margin:0;padding:0;-webkit-user-select:none;user-select:none}
        html{scroll-behavior:smooth}
        body{font-family:'Inter',system-ui,sans-serif;background:#07090f;min-height:100vh;overflow-x:hidden;color:#c8d6e5}
        .mono{font-family:'JetBrains Mono',monospace}
        ::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(99,102,241,0.15);border-radius:10px}

        .sidebar{width:64px;background:rgba(10,12,20,0.99);border-right:1px solid rgba(99,102,241,0.04);transition:width 0.25s ease;display:flex;flex-direction:column;z-index:40;position:fixed;top:0;left:0;height:100vh}
        .sidebar.expanded{width:220px}
        .sidebar.expanded .s-text{opacity:1;max-width:160px;margin-left:8px}
        .s-text{opacity:0;max-width:0;overflow:hidden;white-space:nowrap;transition:all 0.2s;font-size:11px}
        .nav-btn{display:flex;align-items:center;padding:7px 10px;margin:1px 5px;border-radius:7px;transition:all 0.12s;cursor:pointer;border:none;background:transparent;color:#5a6a84;width:calc(100% - 10px);text-align:left;position:relative;font-size:11px}
        .nav-btn:hover{background:rgba(99,102,241,0.06);color:#a5b4fc}
        .nav-btn.active{background:rgba(99,102,241,0.1);color:#818cf8}
        .nav-btn.active::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:14px;background:#818cf8;border-radius:0 3px 3px 0}
        .nav-cat{font-size:7px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:#252d3d;padding:12px 16px 3px;transition:all 0.2s}
        .sidebar:not(.expanded) .nav-cat{opacity:0;height:0;padding:0;overflow:hidden}

        .card{background:rgba(12,15,24,0.85);border:1px solid rgba(99,102,241,0.05);border-radius:10px;transition:border-color 0.15s,transform 0.15s}
        .card:hover{border-color:rgba(99,102,241,0.1)}

        .sw{position:relative;width:36px;height:19px;flex-shrink:0;cursor:pointer}
        .sw input{display:none}
        .sw-bg{position:absolute;inset:0;background:#171c2e;border-radius:10px;transition:background 0.2s;border:1px solid rgba(100,116,139,0.1)}
        .sw input:checked+.sw-bg{background:linear-gradient(135deg,#6366f1,#4f46e5);border-color:#818cf8}
        .sw-dot{position:absolute;top:2.5px;left:2.5px;width:14px;height:14px;background:#6b7fa0;border-radius:50%;transition:all 0.2s cubic-bezier(0.68,-0.55,0.27,1.55);pointer-events:none}
        .sw input:checked~.sw-dot{left:19px;background:#fff}

        input[type="range"]{-webkit-appearance:none;height:3px;background:rgba(22,27,42,0.9);border-radius:10px;outline:none;width:100%}
        input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;background:linear-gradient(135deg,#6366f1,#818cf8);border-radius:50%;cursor:pointer}

        .sel{background:rgba(12,15,24,0.9);border:1px solid rgba(99,102,241,0.08);color:#c8d6e5;appearance:none;border-radius:7px;padding:6px 26px 6px 9px;font-size:10px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' fill='%23818cf8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 7px center;cursor:pointer}

        .btn{font-weight:600;cursor:pointer;transition:all 0.12s;border-radius:7px;border:none;color:white;display:inline-flex;align-items:center;justify-content:center;gap:4px;font-size:10px}
        .btn-p{background:linear-gradient(135deg,#6366f1,#4f46e5)}.btn-s{background:linear-gradient(135deg,#10b981,#059669)}.btn-d{background:linear-gradient(135deg,#ef4444,#dc2626)}.btn-a{background:linear-gradient(135deg,#f59e0b,#d97706)}.btn-v{background:linear-gradient(135deg,#8b5cf6,#7c3aed)}.btn-g{background:rgba(99,102,241,0.05);color:#a5b4fc;border:1px solid rgba(99,102,241,0.08)}

        .badge{font-size:7px;padding:2px 5px;border-radius:20px;font-weight:600}
        .b-l{color:#34d399;background:rgba(52,211,153,0.07);border:1px solid rgba(52,211,153,0.1)}
        .b-m{color:#fbbf24;background:rgba(251,191,36,0.07);border:1px solid rgba(251,191,36,0.1)}
        .b-h{color:#f87171;background:rgba(248,113,113,0.07);border:1px solid rgba(248,113,113,0.1)}

        .kb-input{background:rgba(10,12,20,0.9);border:1px solid rgba(99,102,241,0.1);border-radius:5px;padding:4px 8px;min-width:80px;text-align:center;cursor:pointer;transition:all 0.15s;font-family:'JetBrains Mono',monospace;font-size:9px;color:#fbbf24;font-weight:600}
        .kb-input.rec{border-color:#f59e0b;box-shadow:0 0 8px rgba(245,158,11,0.1)}

        .stat{background:rgba(12,15,24,0.5);border:1px solid rgba(99,102,241,0.04);border-radius:8px}
        .term{background:rgba(6,8,13,0.95);border:1px solid rgba(99,102,241,0.05);border-radius:8px;overflow:hidden}
        .term-body{padding:10px;max-height:250px;overflow-y:auto;line-height:1.6;font-size:9px;font-family:'JetBrains Mono',monospace}

        .overlay{background:rgba(0,0,0,0.5);backdrop-filter:blur(6px)}
        .modal{background:linear-gradient(180deg,rgba(12,15,24,0.98),rgba(10,12,20,0.98));border:1px solid rgba(99,102,241,0.07);border-radius:14px;box-shadow:0 20px 50px rgba(0,0,0,0.4)}

        .notif-stack{position:fixed;bottom:14px;right:14px;z-index:999;display:flex;flex-direction:column-reverse;gap:5px;pointer-events:none}
        .notif{padding:8px 14px;border-radius:8px;font-size:10px;font-weight:600;color:white;box-shadow:0 4px 16px rgba(0,0,0,0.3);pointer-events:auto;max-width:280px}

        .search-overlay{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,0.4);backdrop-filter:blur(4px);display:none;align-items:flex-start;justify-content:center;padding-top:12vh}
        .search-overlay.show{display:flex}
        .search-box{width:100%;max-width:440px;background:rgba(12,15,24,0.98);border:1px solid rgba(99,102,241,0.1);border-radius:12px;overflow:hidden}
        .search-input{width:100%;background:transparent;border:none;padding:12px 16px;color:white;font-size:13px;outline:none}
        .search-item{padding:8px 16px;cursor:pointer;display:flex;align-items:center;gap:8px;transition:background 0.1s;font-size:10px}
        .search-item:hover{background:rgba(99,102,241,0.06)}

        .section-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:6px}
        @media(max-width:640px){.section-grid{grid-template-columns:1fr}}

        .gauge-ring{fill:none;stroke-linecap:round;transition:stroke-dashoffset 0.6s ease}

        .credit-gradient{background:linear-gradient(135deg,#6366f1,#8b5cf6,#ec4899,#6366f1);background-size:300% 300%;animation:gShift 5s ease infinite;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .heart-beat{animation:hBeat 1.5s ease infinite}

        @keyframes fadeUp{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
        @keyframes fadeOut{to{opacity:0;transform:translateY(4px)}}
        @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.3}}
        @keyframes gShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
        @keyframes hBeat{0%,100%{transform:scale(1)}14%{transform:scale(1.12)}28%{transform:scale(1)}42%{transform:scale(1.08)}56%{transform:scale(1)}}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
        @keyframes scaleIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}
        @keyframes borderDance{0%{border-color:rgba(99,102,241,0.2)}33%{border-color:rgba(139,92,246,0.2)}66%{border-color:rgba(236,72,153,0.2)}100%{border-color:rgba(99,102,241,0.2)}}

        .fade-up{animation:fadeUp 0.15s ease both}
        .spin-s{animation:spin 3s linear infinite}.spin-m{animation:spin 1.5s linear infinite}.spin-f{animation:spin 0.6s linear infinite}
        .pulse-a{animation:pulse 2s ease infinite}
        .stagger>*{opacity:0;animation:fadeUp 0.2s ease both}
        .stagger>*:nth-child(1){animation-delay:0.02s}.stagger>*:nth-child(2){animation-delay:0.04s}.stagger>*:nth-child(3){animation-delay:0.06s}.stagger>*:nth-child(4){animation-delay:0.08s}.stagger>*:nth-child(5){animation-delay:0.1s}.stagger>*:nth-child(6){animation-delay:0.12s}

        .loader-screen{position:fixed;inset:0;z-index:9999;background:#07090f;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity 0.3s}
        .loader-screen.hide{opacity:0;pointer-events:none}
        .loader-bar{width:160px;height:2px;background:rgba(99,102,241,0.06);border-radius:10px;overflow:hidden;margin-top:16px}
        .loader-fill{height:100%;background:linear-gradient(90deg,#6366f1,#818cf8);border-radius:10px;transition:width 0.2s;width:0%}

        .status-bar{background:rgba(6,8,13,0.9);border-top:1px solid rgba(99,102,241,0.03)}

        .preset-btn{background:rgba(12,15,24,0.5);border:1px solid rgba(99,102,241,0.05);border-radius:8px;padding:8px 12px;cursor:pointer;transition:all 0.15s;text-align:left;width:100%;display:block}
        .preset-btn:hover{border-color:rgba(99,102,241,0.12);transform:translateX(2px)}

        .qa-btn{background:rgba(12,15,24,0.6);border:1px solid rgba(99,102,241,0.05);border-radius:8px;padding:10px;text-align:center;cursor:pointer;transition:all 0.15s}
        .qa-btn:hover{border-color:rgba(99,102,241,0.12);transform:translateY(-1px)}

        .fan-box{background:rgba(6,8,13,0.9);border:1px solid rgba(99,102,241,0.05);border-radius:8px}
        .hw-card{background:linear-gradient(135deg,rgba(99,102,241,0.04),rgba(59,130,246,0.02));border:1px solid rgba(99,102,241,0.08);border-radius:10px}

        .star{position:absolute;width:2px;height:2px;background:white;border-radius:50%;animation:float 3s ease-in-out infinite;pointer-events:none;opacity:0.15}
        .orb{position:absolute;border-radius:50%;pointer-events:none;animation:float 6s ease-in-out infinite}
        .orb-1{width:60px;height:60px;background:radial-gradient(circle,rgba(99,102,241,0.04),transparent);top:8%;right:5%}
        .orb-2{width:45px;height:45px;background:radial-gradient(circle,rgba(139,92,246,0.03),transparent);bottom:18%;left:6%;animation-delay:-3s}
        .tech-badge{display:inline-flex;align-items:center;gap:2px;padding:2px 6px;border-radius:12px;font-size:8px;font-weight:600;border:1px solid;animation:borderDance 3s ease infinite}
        .timeline-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0;background:linear-gradient(135deg,#6366f1,#8b5cf6);box-shadow:0 0 4px rgba(99,102,241,0.3);position:relative;z-index:1}
        .hover-glow:hover{box-shadow:0 0 15px rgba(99,102,241,0.06);border-color:rgba(99,102,241,0.12)!important}
        .credit-avatar{animation:float 3s ease-in-out infinite}

        .v-tag{animation:borderDance 3s ease infinite}
        pre{white-space:pre-wrap;word-wrap:break-word}

        .score-circle{position:relative;display:inline-flex;align-items:center;justify-content:center}
        .score-circle svg{transform:rotate(-90deg)}
        .score-val{position:absolute;font-size:8px;font-weight:900;color:white}

        .block-screen{position:fixed;inset:0;z-index:99999;background:#07090f;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:20px}

        @media(max-width:768px){
            .sidebar{transform:translateX(-100%)}
            .sidebar.mob{transform:translateX(0);width:220px;box-shadow:4px 0 30px rgba(0,0,0,0.5)}
            .sidebar.mob .s-text{opacity:1;max-width:160px;margin-left:8px}
            .sidebar.mob .nav-cat{opacity:1;height:auto;padding:12px 16px 3px}
            main{margin-left:0!important}
            .status-bar{left:0!important}
        }
    </style>
</head>
<body>

<!-- PANTALLA DE BLOQUEO -->
<div id="blockScreen" class="block-screen">
    <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-violet-600 rounded-2xl flex items-center justify-center text-2xl font-black text-white mb-5 shadow-lg shadow-indigo-500/20" style="animation:float 3s ease-in-out infinite">PC</div>
    <h2 class="text-xl font-black text-white mb-1">PCTuner Pro v6</h2>
    <p class="text-[11px] text-slate-500 mb-5">Optimizador de PC Universal</p>

    <div class="card p-5 max-w-md w-full mb-4" style="background:linear-gradient(135deg,rgba(12,15,24,0.95),rgba(16,12,30,0.9))">
        <div class="text-center mb-4">
            <p class="text-3xl mb-2">üöÄ</p>
            <h3 class="text-sm font-bold text-white mb-1">Instalar PCTuner Pro</h3>
            <p class="text-[9px] text-slate-500">Descarga e instala en 2 clics</p>
        </div>

        <div class="space-y-3 mb-4">
            <div class="flex items-start gap-3">
                <div class="w-7 h-7 bg-indigo-500/15 rounded-lg flex items-center justify-center text-xs font-black text-indigo-400 flex-shrink-0 mt-0.5">1</div>
                <div class="flex-1">
                    <p class="text-[10px] text-white font-bold mb-1">Descarga los 2 archivos</p>
                    <p class="text-[8px] text-slate-500 mb-2">Gu√°rdalos en la <strong class="text-slate-300">misma carpeta</strong></p>
                    <div class="flex gap-2">
                        <button onclick="blockDlPS1()" class="flex-1 py-2 px-3 rounded-lg text-[10px] font-bold text-white cursor-pointer border-none" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed)">‚¨á Crear_EXE.ps1</button>
                        <button onclick="blockDlHTML()" class="flex-1 py-2 px-3 rounded-lg text-[10px] font-bold text-white cursor-pointer border-none" style="background:linear-gradient(135deg,#6366f1,#4f46e5)">‚¨á index.html</button>
                    </div>
                </div>
            </div>

            <div class="flex items-start gap-3">
                <div class="w-7 h-7 bg-indigo-500/15 rounded-lg flex items-center justify-center text-xs font-black text-indigo-400 flex-shrink-0 mt-0.5">2</div>
                <div>
                    <p class="text-[10px] text-white font-bold">Clic derecho en Crear_EXE.ps1</p>
                    <p class="text-[8px] text-slate-500">‚Üí <strong class="text-indigo-400">Ejecutar con PowerShell</strong></p>
                </div>
            </div>

            <div class="flex items-start gap-3">
                <div class="w-7 h-7 bg-emerald-500/15 rounded-lg flex items-center justify-center text-xs font-black text-emerald-400 flex-shrink-0 mt-0.5">‚úì</div>
                <div>
                    <p class="text-[10px] text-white font-bold">¬°Listo! Se instala y abre solo</p>
                    <p class="text-[8px] text-slate-500">Acceso directo en Escritorio y Men√∫ Inicio</p>
                </div>
            </div>
        </div>

        <button onclick="blockDlAll()" class="w-full py-3 px-4 rounded-xl text-[12px] font-bold text-white cursor-pointer border-none shadow-lg" style="background:linear-gradient(135deg,#10b981,#059669);shadow:0 4px 15px rgba(16,185,129,0.3)">
            ‚¨á Descargar Todo e Instalar
        </button>
        <p class="text-[7px] text-slate-700 text-center mt-2">Descarga ambos ‚Üí Ejecuta Crear_EXE.ps1 ‚Üí PCTuner se instala solo</p>
    </div>

    <div class="card p-3 max-w-md w-full mb-3" style="border-left:2px solid rgba(245,158,11,0.3)">
        <div class="flex items-start gap-2">
            <span class="text-sm">üí°</span>
            <div>
                <p class="text-[8px] text-amber-200/70">Si PowerShell bloquea la ejecuci√≥n, abre PowerShell como Admin y ejecuta:</p>
                <p class="text-[9px] text-amber-400 font-bold mt-0.5 cursor-pointer" style="font-family:'JetBrains Mono',monospace" onclick="navigator.clipboard&&navigator.clipboard.writeText('Set-ExecutionPolicy RemoteSigned -Scope CurrentUser')">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser <span class="text-[7px] text-slate-600">(clic para copiar)</span></p>
            </div>
        </div>
    </div>

    <div id="blockNotif" class="hidden" style="position:fixed;bottom:20px;right:20px;padding:10px 18px;border-radius:10px;background:#10b981;color:white;font-size:11px;font-weight:600;box-shadow:0 4px 15px rgba(0,0,0,0.3);animation:fadeUp 0.2s ease"></div>

    <p class="text-[7px] text-slate-800 mt-4">PCTuner Pro v6 ¬∑ mueblesito</p>
</div>

<!-- LOADER -->
<div id="loader" class="loader-screen" style="display:none">
    <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-violet-600 rounded-xl flex items-center justify-center text-xs font-black text-white mb-3">PC</div>
    <div class="loader-bar"><div class="loader-fill" id="lFill"></div></div>
    <p class="text-[9px] text-indigo-400 font-semibold tracking-[1.5px] mt-2" id="lTxt">INICIANDO</p>
    <p class="text-[7px] text-slate-800 mt-5">PCTuner Pro v6</p>
</div>

<!-- B√öSQUEDA -->
<div id="searchOverlay" class="search-overlay" onclick="if(event.target===this)closeSearch()">
    <div class="search-box fade-up">
        <div class="flex items-center gap-2 px-3 pt-1">
            <svg width="12" height="12" fill="none" stroke="#6366f1" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
            <input type="text" class="search-input" id="searchInput" placeholder="Buscar..." oninput="onSearch(this.value)" autocomplete="off">
            <kbd class="text-[7px] text-slate-600 bg-slate-800/50 px-1 py-0.5 rounded font-mono">ESC</kbd>
        </div>
        <div class="max-h-[260px] overflow-y-auto border-t border-white/[0.03]" id="searchResults"></div>
    </div>
</div>

<!-- MOBILE -->
<button id="mobBtn" class="md:hidden fixed top-2.5 left-2.5 z-[60] p-1.5 rounded-lg bg-slate-800/90 border border-slate-700/30 text-white cursor-pointer" onclick="document.getElementById('sb').classList.toggle('mob');document.getElementById('sbBD').classList.toggle('hidden')">
    <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="3" y1="3.5" x2="11" y2="3.5"/><line x1="3" y1="7" x2="11" y2="7"/><line x1="3" y1="10.5" x2="11" y2="10.5"/></svg>
</button>
<div id="sbBD" class="fixed inset-0 bg-black/40 z-[39] hidden md:hidden" onclick="document.getElementById('sb').classList.remove('mob');this.classList.add('hidden')"></div>

<!-- SIDEBAR -->
<aside id="sb" class="sidebar">
    <div class="p-3 flex items-center justify-between border-b border-white/[0.02] min-h-[48px]">
        <div class="flex items-center">
            <div class="w-7 h-7 bg-gradient-to-br from-indigo-500 to-violet-600 rounded-lg flex items-center justify-center text-[9px] font-black text-white flex-shrink-0 cursor-pointer" onclick="go('credits')" title="PCTuner Pro">PC</div>
            <div class="s-text"><h1 class="font-extrabold text-white text-xs leading-tight">PCTuner</h1><p class="text-[6px] font-bold text-indigo-400 tracking-[2px] mt-0.5 v-tag">PRO v6</p></div>
        </div>
        <button onclick="toggleSB()" class="s-text w-4 h-4 flex items-center justify-center rounded text-slate-600 hover:text-white cursor-pointer"><svg width="10" height="10" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg></button>
    </div>
    <nav class="flex-1 overflow-y-auto py-1" id="nav"></nav>
    <div class="p-2 border-t border-white/[0.02]">
        <button onclick="openSearch()" class="w-full nav-btn justify-center gap-1 text-[8px] !text-slate-600 hover:!text-indigo-400 !p-1">
            <svg width="10" height="10" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
            <span class="s-text text-[8px]">Ctrl+K</span>
        </button>
        <button onclick="toggleSB()" class="w-full nav-btn justify-center gap-1 text-[8px] !text-slate-600 hover:!text-indigo-400 !p-1">
            <svg width="10" height="10" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 18l6-6-6-6"/></svg>
            <span class="s-text text-[8px]">Colapsar</span>
        </button>
        <div class="flex items-center gap-1 px-2 mt-1"><span class="w-1.5 h-1.5 bg-emerald-400 rounded-full pulse-a flex-shrink-0"></span><span class="s-text text-[7px] text-slate-600" id="sbSt">Detectando...</span></div>
    </div>
</aside>

<!-- MAIN -->
<main style="margin-left:64px;transition:margin-left 0.25s ease" class="min-h-screen relative z-10">
    <header class="sticky top-0 z-30 px-3 py-2 flex items-center justify-between bg-[rgba(10,12,20,0.92)] backdrop-blur-xl border-b border-white/[0.02]">
        <div class="flex items-center gap-2 ml-6 md:ml-0">
            <h2 id="pTitle" class="text-xs font-bold text-white">Cargando...</h2>
            <span id="pBadge" class="text-[7px] bg-indigo-500/8 text-indigo-400 px-1.5 py-0.5 rounded-full border border-indigo-500/8 font-medium">‚Äî</span>
        </div>
        <div class="flex items-center gap-1.5">
            <div id="perfScore" class="hidden md:flex items-center gap-1 bg-emerald-500/5 border border-emerald-500/8 rounded-full px-1.5 py-0.5 cursor-pointer" onclick="go('monitor')">
                <div class="score-circle"><svg width="20" height="20" viewBox="0 0 36 36"><circle cx="18" cy="18" r="14" fill="none" stroke="rgba(16,185,129,0.1)" stroke-width="2.5"/><circle cx="18" cy="18" r="14" fill="none" stroke="#10b981" stroke-width="2.5" stroke-dasharray="88" stroke-dashoffset="22" stroke-linecap="round" id="scoreRing"/></svg><span class="score-val" id="scoreVal">75</span></div>
            </div>
            <span id="clock" class="hidden md:block text-[8px] mono text-slate-600 bg-slate-800/25 px-1.5 py-0.5 rounded-full"></span>
            <span id="cBadge" class="text-[7px] mono text-amber-400 bg-amber-500/6 px-1.5 py-0.5 rounded-full border border-amber-500/8 hidden font-semibold"></span>
            <button onclick="quickExec()" class="btn btn-s px-2.5 py-1.5"><svg width="9" height="9" fill="currentColor" viewBox="0 0 16 16"><path d="M4 2l10 6-10 6z"/></svg><span class="hidden sm:inline">Ejecutar</span></button>
            <button onclick="openExport()" class="btn btn-p px-2.5 py-1.5"><svg width="9" height="9" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 5v14M5 12l7 7 7-7"/></svg><span class="hidden sm:inline">Exportar</span></button>
        </div>
    </header>
    <div class="p-3 md:p-4 max-w-[1300px] mx-auto pb-14" id="content"></div>
    <footer class="status-bar fixed bottom-0 right-0 z-20 px-3 py-0.5 flex items-center justify-between text-[7px] text-slate-700" style="left:64px;transition:left 0.25s ease">
        <div class="flex items-center gap-2"><span class="flex items-center gap-1"><span class="w-1 h-1 bg-emerald-500 rounded-full pulse-a"></span>Activo</span><span id="sbHw" class="hidden md:inline">‚Äî</span></div>
        <div class="flex items-center gap-2"><span id="sbCh">0 cambios</span><span>üõ°Ô∏è Defender OK</span><span class="text-pink-400/40 font-semibold cursor-pointer hover:text-pink-300" onclick="go('donate')">üíñ Donar</span><span class="text-indigo-400/50 font-semibold cursor-pointer hover:text-indigo-300" onclick="go('credits')">PCTuner Pro v6 ¬∑ mueblesito</span></div>
    </footer>
</main>

<!-- NOTIFICACIONES -->
<div class="notif-stack" id="nStack"></div>

<!-- MODAL EJECUTAR -->
<div id="execModal" class="fixed inset-0 z-[100] hidden">
    <div class="overlay absolute inset-0" onclick="closeExec()"></div>
    <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
        <div class="modal w-full max-w-lg fade-up">
            <div class="flex items-center justify-between px-4 py-2.5 border-b border-white/[0.03]">
                <div class="flex items-center gap-2"><div class="flex gap-1"><div class="w-2.5 h-2.5 bg-red-500 rounded-full cursor-pointer" onclick="closeExec()"></div><div class="w-2.5 h-2.5 bg-yellow-500 rounded-full"></div><div class="w-2.5 h-2.5 bg-green-500 rounded-full"></div></div><span class="text-[11px] text-slate-300 font-semibold ml-1">Ejecutar</span></div>
            </div>
            <div id="execBody" class="p-4 max-h-[55vh] overflow-y-auto"></div>
        </div>
    </div>
</div>

<!-- MODAL EXPORTAR -->
<div id="exportModal" class="fixed inset-0 z-[100] hidden">
    <div class="overlay absolute inset-0" onclick="closeExport()"></div>
    <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
        <div class="modal w-full max-w-xl max-h-[70vh] overflow-hidden flex flex-col fade-up">
            <div class="flex items-center justify-between px-4 py-2.5 border-b border-white/[0.03]">
                <div class="flex items-center gap-2"><div class="flex gap-1"><div class="w-2.5 h-2.5 bg-red-500 rounded-full cursor-pointer" onclick="closeExport()"></div><div class="w-2.5 h-2.5 bg-yellow-500 rounded-full"></div><div class="w-2.5 h-2.5 bg-green-500 rounded-full"></div></div><span class="text-[11px] text-slate-300 font-semibold ml-1" id="expTitle">Exportar</span></div>
                <div class="flex gap-1"><select id="expFmt" class="sel text-[9px]"><option value="bat">.BAT</option><option value="ps1">.PS1</option><option value="reg">.REG</option><option value="ahk">.AHK</option></select><button onclick="genScript()" class="btn btn-p px-2.5 py-1.5">‚ö° Generar</button></div>
            </div>
            <div id="expBody" class="flex-1 overflow-auto"><div class="p-4 text-center text-slate-600"><p class="text-xl mb-1">üì¶</p><p class="text-[10px]">Selecciona formato y clic en <strong class="text-indigo-400">Generar</strong></p></div></div>
            <div id="expFoot" class="px-4 py-2 border-t border-white/[0.03] flex justify-between items-center hidden">
                <span class="text-[8px] text-slate-600 mono" id="expInfo"></span>
                <div class="flex gap-1"><button onclick="copyCode()" id="copyBtn" class="btn btn-p px-2.5 py-1.5">üìã Copiar</button><button onclick="dlCode()" class="btn btn-s px-2.5 py-1.5">‚¨á Descargar</button></div>
            </div>
        </div>
    </div>
</div>

<script>
// ==================== PROTECCI√ìN ====================
(function(){
    const isApp = window.navigator.standalone
        || window.matchMedia('(display-mode:standalone)').matches
        || window.matchMedia('(display-mode:fullscreen)').matches
        || window.location.protocol === 'file:'
        || window.navigator.userAgent.includes('Electron')
        || (document.referrer === '' && window.opener === null);

    if(!isApp){
        document.getElementById('blockScreen').style.display = 'flex';
        document.getElementById('loader').style.display = 'none';
        return;
    }

    document.getElementById('blockScreen').style.display = 'none';
    document.getElementById('loader').style.display = 'flex';

    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', e => {
        if(e.key === 'F12'
            || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C'))
            || (e.ctrlKey && e.key === 'u')
            || (e.ctrlKey && e.key === 's'))
            e.preventDefault();
    });
})();

// ==================== FUNCIONES DE DESCARGA (BLOCK SCREEN) ====================
function blockNotify(msg){const n=document.getElementById('blockNotif');if(!n)return;n.textContent=msg;n.classList.remove('hidden');setTimeout(()=>n.classList.add('hidden'),2500);}
function blockDlFile(name,content){const b=new Blob([content],{type:'text/plain'}),u=URL.createObjectURL(b),a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);}
function blockDlHTML(){const b=new Blob([document.documentElement.outerHTML],{type:'text/html'}),u=URL.createObjectURL(b),a=document.createElement('a');a.href=u;a.download='index.html';document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);blockNotify('‚úÖ index.html descargado');}
function blockDlPS1(){blockDlFile('Crear_EXE.ps1',getPS1Content());blockNotify('‚úÖ Crear_EXE.ps1 descargado');}
function blockDlAll(){blockDlPS1();setTimeout(()=>blockDlHTML(),500);}
function getPS1Content(){return `# ============================================
# PCTuner Pro v6 ‚Äî Instalador Automatico
# Solo ejecuta este archivo con PowerShell
# ============================================

Write-Host ""
Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor Cyan
Write-Host "  ‚ïë     PCTuner Pro v6 ‚Äî Instalador      ‚ïë" -ForegroundColor Cyan
Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor Cyan
Write-Host ""

$scriptDir = $PSScriptRoot
$htmlFile = Join-Path $scriptDir "index.html"

if (-not (Test-Path $htmlFile)) {
    Write-Host "  [ERROR] index.html no encontrado!" -ForegroundColor Red
    Write-Host "  Coloca index.html junto a este archivo." -ForegroundColor Yellow
    Read-Host "  Presiona Enter para cerrar"
    exit
}

Write-Host "  [1/5] Creando carpeta de instalacion..." -ForegroundColor Yellow
$installDir = Join-Path $env:LOCALAPPDATA "PCTuner"
if (-not (Test-Path $installDir)) { New-Item -Path $installDir -ItemType Directory -Force | Out-Null }

Write-Host "  [2/5] Copiando archivos..." -ForegroundColor Yellow
Copy-Item $htmlFile (Join-Path $installDir "index.html") -Force

Write-Host "  [3/5] Compilando PCTuner.exe..." -ForegroundColor Yellow

$exeSrc = @"
using System;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;

class PCTuner {
    [DllImport("kernel32.dll")] static extern IntPtr GetConsoleWindow();
    [DllImport("user32.dll")] static extern bool ShowWindow(IntPtr h, int s);

    static void Main() {
        ShowWindow(GetConsoleWindow(), 0);
        string dir = AppDomain.CurrentDomain.BaseDirectory;
        string html = Path.Combine(dir, "index.html");
        if (!File.Exists(html)) { return; }
        string url = "file:///" + html.Replace("\\\\", "/");
        string[] browsers = { "chrome", "msedge" };
        foreach (var b in browsers) {
            try {
                var psi = new ProcessStartInfo(b);
                psi.Arguments = "--app=\\"" + url + "\\" --window-size=1300,850 --disable-extensions --disable-sync --no-first-run --disable-default-apps";
                psi.UseShellExecute = false;
                psi.CreateNoWindow = true;
                Process.Start(psi);
                return;
            } catch {}
        }
        Process.Start(html);
    }
}
"@

try {
    Add-Type -TypeDefinition $exeSrc -OutputAssembly (Join-Path $installDir "PCTuner.exe") -OutputType ConsoleApplication -ErrorAction Stop
    Write-Host "  [3/5] PCTuner.exe compilado OK!" -ForegroundColor Green
} catch {
    Write-Host "  [3/5] Usando launcher alternativo..." -ForegroundColor Yellow
    $bat = "@echo off`nstart /b """" chrome --app=""file:///$($installDir.Replace('\\','/'))/index.html"" --window-size=1300,850 2>nul || start /b """" msedge --app=""file:///$($installDir.Replace('\\','/'))/index.html"" --window-size=1300,850"
    Set-Content (Join-Path $installDir "PCTuner.bat") $bat
}

Write-Host "  [4/5] Creando acceso directo en Escritorio..." -ForegroundColor Yellow
$desktop = [Environment]::GetFolderPath("Desktop")
$exePath = Join-Path $installDir "PCTuner.exe"
if (-not (Test-Path $exePath)) { $exePath = Join-Path $installDir "PCTuner.bat" }

$shell = New-Object -ComObject WScript.Shell
$shortcut = $shell.CreateShortcut((Join-Path $desktop "PCTuner Pro.lnk"))
$shortcut.TargetPath = $exePath
$shortcut.WorkingDirectory = $installDir
$shortcut.Description = "PCTuner Pro v6"
$shortcut.Save()

Write-Host "  [5/5] Creando acceso en Menu Inicio..." -ForegroundColor Yellow
$startMenu = Join-Path $env:APPDATA "Microsoft\\Windows\\Start Menu\\Programs"
$shortcut2 = $shell.CreateShortcut((Join-Path $startMenu "PCTuner Pro.lnk"))
$shortcut2.TargetPath = $exePath
$shortcut2.WorkingDirectory = $installDir
$shortcut2.Description = "PCTuner Pro v6"
$shortcut2.Save()

Write-Host ""
Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor Green
Write-Host "  ‚ïë  INSTALACION COMPLETADA!             ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïë  Acceso directo en Escritorio        ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïë  Acceso en Menu Inicio               ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor Green
Write-Host ""

Write-Host "  Abriendo PCTuner Pro..." -ForegroundColor Cyan
Start-Process $exePath -WorkingDirectory $installDir

Start-Sleep -Seconds 3
`;}

// ==================== ESTADO GLOBAL ====================
const S={page:'dashboard',hw:{},toggles:{},sliders:{},selects:{},keybinds:{},fan:{profiles:{silent:{curve:[{t:30,s:8},{t:45,s:18},{t:60,s:30},{t:75,s:50},{t:90,s:65}],min:5,max:70},balanced:{curve:[{t:30,s:10},{t:45,s:25},{t:60,s:50},{t:75,s:80},{t:90,s:100}],min:10,max:100},performance:{curve:[{t:30,s:30},{t:45,s:50},{t:60,s:70},{t:75,s:90},{t:90,s:100}],min:25,max:100},custom:{curve:[{t:30,s:10},{t:45,s:25},{t:60,s:50},{t:75,s:80},{t:90,s:100}],min:10,max:100}},profile:'balanced',get curve(){return this.profiles[this.profile].curve},set curve(v){this.profiles[this.profile].curve=v}},changes:{},mon:{cpu:0,ram:0,temp:0,rpm:0,disk:0,up:'0h 0m',net:0},hist:{cpu:[],ram:[],temp:[]}};
let cCount=0,_code='',_fn='',_vis=true;

document.addEventListener('visibilitychange',()=>{_vis=!document.hidden});

// ==================== LOADER ====================
let _ls=0;const _lt=['Detectando hardware...','Analizando GPU...','Cargando m√≥dulos...','¬°Listo!'];
function animL(){if(_ls>=_lt.length)return;const f=document.getElementById('lFill');if(f)f.style.width=Math.min(100,(_ls+1)/_lt.length*100)+'%';const t=document.getElementById('lTxt');if(t)t.textContent=_lt[_ls]||'';_ls++;if(_ls<_lt.length)setTimeout(animL,80);}
setTimeout(animL,60);

// ==================== DETECCI√ìN DE HARDWARE ====================
async function detectHW(){const u=navigator.userAgent,h=S.hw;h.userAgent=u;h.lang=navigator.language;h.screenW=screen.width;h.screenH=screen.height;h.dpr=devicePixelRatio||1;h.touch='ontouchstart'in window;h.cores=navigator.hardwareConcurrency||1;h.ram=navigator.deviceMemory||0;
if(u.includes('Windows NT 10.0')){h.os='Windows';h.osVer='10/11';if(navigator.userAgentData)try{const d=await navigator.userAgentData.getHighEntropyValues(['platformVersion','architecture','bitness']);h.arch=d.architecture||'x86';h.bitness=d.bitness||'';if(d.platformVersion){const v=parseInt(d.platformVersion.split('.')[0]);h.osVer=v>=13?'11':'10';}}catch(e){}}else if(u.includes('Mac OS'))h.os='macOS';else if(u.includes('Linux'))h.os='Linux';else if(u.includes('Android'))h.os='Android';else if(u.includes('iPhone')||u.includes('iPad'))h.os='iOS';else h.os='Otro';
if(!h.arch)h.arch=u.includes('x64')||u.includes('WOW64')?'x64':u.includes('ARM')?'ARM64':'x86';
h.browser=u.includes('Edg/')?'Edge':u.includes('OPR/')?'Opera':u.includes('Firefox')?'Firefox':u.includes('Safari')&&!u.includes('Chrome')?'Safari':u.includes('Chrome')?'Chrome':'Otro';
const br=[[/Lenovo|IdeaPad|ThinkPad|Legion/i,'Lenovo'],[/ASUS|ROG|ZenBook|TUF/i,'ASUS'],[/Acer|Aspire|Nitro|Predator/i,'Acer'],[/Dell|Inspiron|XPS|Alienware/i,'Dell'],[/HP|Hewlett|Pavilion|Omen/i,'HP'],[/MSI|Katana|Stealth/i,'MSI'],[/Samsung/i,'Samsung'],[/Apple|Macintosh/i,'Apple'],[/Huawei/i,'Huawei'],[/Surface/i,'Microsoft'],[/Razer/i,'Razer'],[/Xiaomi/i,'Xiaomi']];
for(const[r,n]of br)if(r.test(u)){h.brand=n;break;}if(!h.brand)h.brand='PC';
try{const c=document.createElement('canvas');let gl=c.getContext('webgl2')||c.getContext('webgl');if(gl){h.webglVer=c.getContext('webgl2')?2:1;const x=gl.getExtension('WEBGL_debug_renderer_info');if(x){h.gpu=gl.getParameter(x.UNMASKED_RENDERER_WEBGL)||'';h.gpuVendor=gl.getParameter(x.UNMASKED_VENDOR_WEBGL)||'';h.gpuClean=h.gpu.replace(/ANGLE \(/,'').replace(/\)$/,'').replace(/Direct3D\d+/g,'').replace(/vs_\d+_\d+/g,'').replace(/ps_\d+_\d+/g,'').replace(/,\s*,/g,',').replace(/,\s*$/,'').trim();
const g=h.gpu.toLowerCase();h.gpuTier=/rtx\s*4[0-9]{2}0|rx\s*7900/i.test(g)?'Ultra':/rtx\s*[23]0[6-9]0|rx\s*6[89]00/i.test(g)?'Alto':/rtx\s*[23]0[56]0|gtx\s*16[678]0|rx\s*[56][67]00/i.test(g)?'Medio':/gtx\s*1[0-5]|mx|rx\s*5[0-4]|gt\s/i.test(g)?'Bajo':'Integrada';
h.gpuBrand=/nvidia|geforce|gtx|rtx/i.test(g)?'NVIDIA':/amd|radeon|rx\s/i.test(g)?'AMD':/intel|iris|uhd/i.test(g)?'Intel':'Otro';
if(h.brand==='PC')for(const[r,n]of br)if(r.test(h.gpu)){h.brand=n;break;}}
h.maxTexture=gl.getParameter(gl.MAX_TEXTURE_SIZE)||0;}}catch(e){}
if(h.gpu){const g=h.gpu;if(/UHD.*7[0-9]{2}/i.test(g)){h.cpuBrand='Intel';h.cpuGen='12th/13th Gen';}else if(/Iris\s*Xe/i.test(g)){h.cpuBrand='Intel';h.cpuGen='11th+ Gen';}else if(/Vega\s*[3-8]$/i.test(g)){h.cpuBrand='AMD';h.cpuGen='Ryzen APU';}else if(/Radeon\s*Graphics$/i.test(g)){h.cpuBrand='AMD';h.cpuGen='Ryzen 4000+';}}
h.cpuClass=h.cores>=16?'Workstation':h.cores>=12?'Enthusiast':h.cores>=8?'Alto':h.cores>=6?'Medio':h.cores>=4?'B√°sico':'Ultra-B√°sico';
h.colorDepth=screen.colorDepth||24;
if(navigator.connection){h.connectionType=navigator.connection.effectiveType||'';h.downlink=navigator.connection.downlink||0;}
if(navigator.getBattery)try{const b=await navigator.getBattery();h.battery=true;h.batteryLevel=Math.round(b.level*100);h.charging=b.charging;}catch(e){}
h.onLine=navigator.onLine;
document.getElementById('sbSt').textContent=h.brand+' ¬∑ '+h.os+(h.osVer?' '+h.osVer:'');}

// ==================== NAVEGACI√ìN ====================
const NAV=[{c:'Principal',i:[{id:'dashboard',ic:'üè†',n:'Dashboard'},{id:'monitor',ic:'üìä',n:'Monitor'},{id:'fans',ic:'üåÄ',n:'Ventiladores'}]},{c:'Optimizaci√≥n',i:[{id:'performance',ic:'‚ö°',n:'Rendimiento'},{id:'cleanup',ic:'üßπ',n:'Limpieza'},{id:'network',ic:'üåê',n:'Red'},{id:'power',ic:'üîã',n:'Energ√≠a'},{id:'startup',ic:'üöÄ',n:'Arranque'},{id:'gaming',ic:'üéÆ',n:'Gaming'}]},{c:'Personalizaci√≥n',i:[{id:'keybinds',ic:'‚å®Ô∏è',n:'Keybinds'},{id:'visual',ic:'üé®',n:'Visual'},{id:'taskbar',ic:'üìå',n:'Taskbar'},{id:'explorer',ic:'üìÅ',n:'Explorador'},{id:'sound',ic:'üîä',n:'Sonido'}]},{c:'Sistema',i:[{id:'privacy',ic:'üõ°Ô∏è',n:'Privacidad'},{id:'services',ic:'‚öôÔ∏è',n:'Servicios'},{id:'updates',ic:'üîÑ',n:'Updates'},{id:'security',ic:'üîí',n:'Seguridad'},{id:'maintenance',ic:'üîß',n:'Mantenimiento'}]},{c:'Herramientas',i:[{id:'terminal',ic:'üíª',n:'Terminal'},{id:'profiles',ic:'üíæ',n:'Perfiles'},{id:'makeapp',ic:'üì¶',n:'Crear App'},{id:'about',ic:'‚ÑπÔ∏è',n:'Info'},{id:'donate',ic:'üíñ',n:'Donaciones'},{id:'credits',ic:'‚ú®',n:'Cr√©ditos'}]}];
const META={dashboard:{t:'Dashboard',b:'Centro de Control'},monitor:{t:'Monitor',b:'Tiempo Real'},fans:{t:'Ventiladores',b:'Control RPM'},performance:{t:'Rendimiento',b:'CPU ¬∑ RAM'},cleanup:{t:'Limpieza',b:'Profunda ¬∑ 15 opciones'},network:{t:'Red',b:'DNS ¬∑ WiFi'},power:{t:'Energ√≠a',b:'Plan'},startup:{t:'Arranque',b:'Inicio'},gaming:{t:'Gaming',b:'FPS'},keybinds:{t:'Keybinds',b:'Atajos'},visual:{t:'Visual',b:'Tema'},taskbar:{t:'Taskbar',b:'Barra'},explorer:{t:'Explorador',b:'Archivos'},sound:{t:'Sonido',b:'Audio'},privacy:{t:'Privacidad',b:'Telemetr√≠a'},services:{t:'Servicios',b:'Windows'},updates:{t:'Updates',b:'Config'},security:{t:'Seguridad',b:'Firewall'},maintenance:{t:'Mantenimiento',b:'Reparar'},terminal:{t:'Terminal',b:'CMD'},profiles:{t:'Perfiles',b:'Guardar'},makeapp:{t:'Crear App',b:'üì¶ .EXE'},about:{t:'Acerca de',b:'v6.0'},donate:{t:'Donaciones',b:'üíñ Apoyar'},credits:{t:'Cr√©ditos',b:'‚ú® mueblesito'}};
const SI=[];function buildSI(){SI.length=0;NAV.forEach(c=>c.i.forEach(i=>SI.push({id:i.id,ic:i.ic,n:i.n,cat:c.c})));}
function openSearch(){document.getElementById('searchOverlay').classList.add('show');document.getElementById('searchInput').value='';document.getElementById('searchInput').focus();onSearch('');}
function closeSearch(){document.getElementById('searchOverlay').classList.remove('show');}
function onSearch(q){const r=document.getElementById('searchResults'),items=q?SI.filter(i=>i.n.toLowerCase().includes(q.toLowerCase())||i.cat.toLowerCase().includes(q.toLowerCase())):SI;r.innerHTML=items.map(i=>`<div class="search-item" onclick="go('${i.id}');closeSearch()"><span class="text-sm w-5 text-center">${i.ic}</span><span class="font-semibold text-slate-300">${i.n}</span><span class="text-[8px] text-slate-600 ml-auto">${i.cat}</span></div>`).join('');}
function buildNav(){let h='';NAV.forEach(c=>{h+=`<div class="nav-cat">${c.c}</div>`;c.i.forEach(i=>{h+=`<button class="nav-btn" data-id="${i.id}" onclick="go('${i.id}')"><span class="text-center text-sm w-5">${i.ic}</span><span class="s-text">${i.n}</span></button>`;});});document.getElementById('nav').innerHTML=h;}
function toggleSB(){const sb=document.getElementById('sb'),m=document.querySelector('main'),f=document.querySelector('.status-bar');if(sb.classList.contains('expanded')){sb.classList.remove('expanded');m.style.marginLeft='64px';if(f)f.style.left='64px';}else{sb.classList.add('expanded');m.style.marginLeft='220px';if(f)f.style.left='220px';}}
function go(id){S.page=id;document.querySelectorAll('.nav-btn').forEach(b=>b.classList.toggle('active',b.dataset.id===id));const m=META[id]||{t:id,b:''};document.getElementById('pTitle').textContent=m.t;document.getElementById('pBadge').textContent=m.b;render(id);document.getElementById('sb').classList.remove('mob');const bd=document.getElementById('sbBD');if(bd)bd.classList.add('hidden');scrollTo({top:0});}
function track(k,v){S.changes[k]=v;cCount=Object.keys(S.changes).length;const b=document.getElementById('cBadge');if(cCount>0){b.classList.remove('hidden');b.textContent=cCount;}else b.classList.add('hidden');updScore();updSB();}
function T(id){return S.toggles[id]}
function SE(id){return S.selects[id]}

// ==================== COMPONENTES ====================
function tog(id,label,desc,def=false,risk='low'){const c=S.toggles[id]!==undefined?S.toggles[id]:def;if(S.toggles[id]===undefined)S.toggles[id]=def;const rc={low:'b-l',med:'b-m',high:'b-h'},rl={low:'seguro',med:'medio',high:'riesgo'};return`<div class="card p-2.5" id="c-${id}" ${c?'style="border-color:rgba(99,102,241,0.18)"':''}><div class="flex items-center justify-between gap-2"><div class="flex-1 min-w-0"><div class="flex items-center gap-1 flex-wrap mb-0.5"><span class="font-semibold text-white text-[10px]">${label}</span><span class="badge ${rc[risk]}">${rl[risk]}</span></div><p class="text-[8px] text-slate-500 leading-relaxed">${desc}</p></div><label class="sw"><input type="checkbox" ${c?'checked':''} onchange="onTog('${id}',this.checked)"><div class="sw-bg"></div><div class="sw-dot"></div></label></div></div>`;}
function sli(id,label,desc,min,max,def,unit=''){const v=S.sliders[id]!==undefined?S.sliders[id]:def;if(S.sliders[id]===undefined)S.sliders[id]=def;return`<div class="card p-2.5"><div class="flex items-center justify-between mb-0.5"><span class="font-semibold text-white text-[10px]">${label}</span><span class="mono text-indigo-400 text-[9px] font-semibold" id="sv-${id}">${v}${unit}</span></div><p class="text-[8px] text-slate-500 mb-1.5">${desc}</p><input type="range" min="${min}" max="${max}" value="${v}" oninput="onSli('${id}',this.value,'${unit}')"></div>`;}
function sel(id,label,desc,opts,def){const v=S.selects[id]!==undefined?S.selects[id]:def;if(S.selects[id]===undefined)S.selects[id]=def;return`<div class="card p-2.5"><div class="flex items-center justify-between flex-wrap gap-2"><div class="flex-1 min-w-0"><span class="font-semibold text-white text-[10px]">${label}</span><p class="text-[8px] text-slate-500 mt-0.5">${desc}</p></div><select class="sel" onchange="onSel('${id}',this.value)">${opts.map(x=>`<option value="${x.v}" ${v===x.v?'selected':''}>${x.l}</option>`).join('')}</select></div></div>`;}
function kb(id,label,desc,def){const v=S.keybinds[id]||def;if(!S.keybinds[id])S.keybinds[id]=def;return`<div class="card p-2.5"><div class="flex items-center justify-between gap-2"><div class="flex-1 min-w-0"><span class="font-semibold text-white text-[10px]">${label}</span><p class="text-[8px] text-slate-500 mt-0.5">${desc}</p></div><div class="flex items-center gap-1"><input type="text" readonly class="kb-input" value="${v}" id="kb-${id}" onclick="recStart('${id}',this)"><button onclick="recReset('${id}','${def}')" class="text-slate-600 hover:text-red-400 text-[8px] cursor-pointer">‚Ü∫</button></div></div></div>`;}
function hdr(icon,title,desc){return`<div class="mb-2.5 fade-up"><h3 class="text-sm font-bold text-white flex items-center gap-1.5">${icon}<span>${title}</span></h3><p class="text-[8px] text-slate-500 mt-0.5 ml-6">${desc}</p></div>`;}
function divider(t){return`<div class="mt-4 mb-2.5 flex items-center gap-2"><div class="h-px flex-1 bg-gradient-to-r from-transparent via-slate-800/40 to-transparent"></div><span class="text-[6px] font-bold text-slate-700 tracking-[2px] uppercase">${t}</span><div class="h-px flex-1 bg-gradient-to-r from-transparent via-slate-800/40 to-transparent"></div></div>`;}
function grid(c){return`<div class="section-grid stagger">${c}</div>`;}

// ==================== EVENTOS ====================
function onTog(id,c){S.toggles[id]=c;track(id,c);const el=document.getElementById('c-'+id);if(el)el.style.borderColor=c?'rgba(99,102,241,0.18)':'rgba(99,102,241,0.05)';}
function onSli(id,v,u){const fm=id.match(/^fan_(min|max)_(silent|balanced|performance|custom)$/);if(fm){S.fan.profiles[fm[2]][fm[1]==='min'?'min':'max']=parseInt(v);track(id,v);const e=document.getElementById('sv-'+id);if(e)e.textContent=v+u;return;}S.sliders[id]=parseInt(v);track(id,v);const e=document.getElementById('sv-'+id);if(e)e.textContent=v+u;}
function onSel(id,v){S.selects[id]=v;track(id,v);}
let _recId=null,_recEl=null;
function recStart(id,el){if(_recEl){_recEl.classList.remove('rec');_recEl.value=S.keybinds[_recId]||'';}_recId=id;_recEl=el;el.classList.add('rec');el.value='‚è∫ Presiona...';}
function recReset(id,def){S.keybinds[id]=def;const e=document.getElementById('kb-'+id);if(e){e.value=def;e.classList.remove('rec');}track('kb_'+id,def);}
document.addEventListener('keydown',e=>{if(_recId){e.preventDefault();let k=[];if(e.ctrlKey)k.push('Ctrl');if(e.altKey)k.push('Alt');if(e.shiftKey)k.push('Shift');if(e.metaKey)k.push('Win');const key=e.key;if(!['Control','Alt','Shift','Meta'].includes(key))k.push(key.length===1?key.toUpperCase():key);const c=k.join(' + ');if(c&&!['Ctrl','Alt','Shift','Win'].includes(c)){S.keybinds[_recId]=c;_recEl.value=c;_recEl.classList.remove('rec');track('kb_'+_recId,c);_recId=null;_recEl=null;}return;}if((e.ctrlKey||e.metaKey)&&e.key==='k'){e.preventDefault();openSearch();}if(e.key==='Escape'){closeExec();closeExport();closeSearch();}});

// ==================== GAUGES Y CHARTS ====================
function gauge(pct,color,label,value,sz=90){const r=35,circ=2*Math.PI*r,off=circ-(Math.min(pct,100)/100)*circ;return`<div class="flex flex-col items-center"><svg width="${sz}" height="${sz}" viewBox="0 0 100 100"><circle cx="50" cy="50" r="${r}" fill="none" stroke="rgba(99,102,241,0.03)" stroke-width="3"/><circle cx="50" cy="50" r="${r}" class="gauge-ring" stroke="${color}" stroke-width="3" stroke-dasharray="${circ}" stroke-dashoffset="${off}" transform="rotate(-90 50 50)"/><text x="50" y="45" text-anchor="middle" fill="white" font-size="13" font-weight="800" font-family="Inter">${value}</text><text x="50" y="57" text-anchor="middle" fill="#4a5568" font-size="7" font-family="Inter">${label}</text></svg></div>`;}
function miniChart(data,color,w=100,h=28){if(!data.length)return'';const max=Math.max(...data,1),pts=data.map((v,i)=>`${(i/(data.length-1))*w},${h-((v/max)*h*0.8+h*0.05)}`).join(' ');return`<svg width="${w}" height="${h}" class="opacity-40"><polyline points="${pts}" fill="none" stroke="${color}" stroke-width="1"/></svg>`;}

// ==================== SIMULACI√ìN MONITOR ====================
function simMon(){if(!_vis)return;const m=S.mon;m.cpu=Math.round(10+Math.random()*50);m.ram=Math.round(35+Math.random()*35);m.temp=Math.round(35+Math.random()*28);m.disk=Math.round(2+Math.random()*20);m.net=Math.round(Math.random()*600)/10;
const cp=S.fan.profiles[S.fan.profile],curve=cp.curve;let speed=curve[0].s;for(let i=0;i<curve.length-1;i++){if(m.temp>=curve[i].t&&m.temp<=curve[i+1].t){speed=curve[i].s+(m.temp-curve[i].t)/(curve[i+1].t-curve[i].t)*(curve[i+1].s-curve[i].s);break;}else if(m.temp>curve[curve.length-1].t)speed=curve[curve.length-1].s;}
speed=Math.max(cp.min,Math.min(cp.max,speed));m.rpm=Math.round(speed*50)+Math.round(Math.random()*80-40);m.up=Math.floor(Math.random()*72)+'h '+Math.floor(Math.random()*60)+'m';
S.hist.cpu.push(m.cpu);S.hist.ram.push(m.ram);S.hist.temp.push(m.temp);if(S.hist.cpu.length>25)S.hist.cpu.shift();if(S.hist.ram.length>25)S.hist.ram.shift();if(S.hist.temp.length>25)S.hist.temp.shift();
if(S.page==='monitor')updMon();if(S.page==='fans')updFanLive();if(S.page==='dashboard')updDash();}

function updMon(){['cpu','ram','temp','disk'].forEach(k=>{const el=document.getElementById('m-'+k);if(!el)return;const m=S.mon,d={cpu:{p:m.cpu,c:m.cpu>80?'#ef4444':m.cpu>50?'#f59e0b':'#10b981',l:'CPU',v:m.cpu+'%'},ram:{p:m.ram,c:m.ram>85?'#ef4444':m.ram>60?'#f59e0b':'#6366f1',l:'RAM',v:m.ram+'%'},temp:{p:m.temp,c:m.temp>75?'#ef4444':m.temp>55?'#f59e0b':'#10b981',l:'TEMP',v:m.temp+'¬∞C'},disk:{p:m.disk,c:'#8b5cf6',l:'DISCO',v:m.disk+'%'}}[k];el.innerHTML=gauge(d.p,d.c,d.l,d.v,100);});
const r=document.getElementById('m-rpm');if(r)r.textContent=S.mon.rpm+' RPM';['cpu','ram','temp'].forEach(k=>{const el=document.getElementById('m-hist-'+k);if(el)el.innerHTML=miniChart(S.hist[k],{cpu:'#10b981',ram:'#6366f1',temp:'#f59e0b'}[k],140,35);});}
function updFanLive(){const r=document.getElementById('f-rpm');if(r)r.textContent=S.mon.rpm;const t=document.getElementById('f-temp');if(t)t.textContent=S.mon.temp+'¬∞C';}
function updDash(){const m=S.mon;const c=document.getElementById('d-cpu');if(c)c.innerHTML=gauge(m.cpu,m.cpu>80?'#ef4444':'#10b981','CPU',m.cpu+'%',80);const r=document.getElementById('d-ram');if(r)r.innerHTML=gauge(m.ram,m.ram>85?'#ef4444':'#6366f1','RAM',m.ram+'%',80);const t=document.getElementById('d-temp');if(t)t.innerHTML=gauge(m.temp,m.temp>70?'#ef4444':'#10b981','TEMP',m.temp+'¬∞C',80);const f=document.getElementById('d-fan');if(f)f.textContent=m.rpm;}

// ==================== RENDER ====================
function render(id){const fn={dashboard:pDash,monitor:pMon,fans:pFans,performance:pPerf,cleanup:pClean,network:pNet,power:pPow,startup:pStart,gaming:pGame,keybinds:pKeys,visual:pVis,taskbar:pTask,explorer:pExp,sound:pSnd,privacy:pPriv,services:pSvc,updates:pUpd,security:pSec,maintenance:pMaint,terminal:pTerm,profiles:pProf,makeapp:pMakeApp,about:pAbout,donate:pDonate,credits:pCredits};document.getElementById('content').innerHTML=(fn[id]||pDash)();if(id==='fans')initFanCanvas();}

// ==================== P√ÅGINAS ====================
function pDash(){const h=S.hw,gpu=(h.gpuClean||h.gpu||'N/A').substring(0,35);return`<div class="hw-card p-3 mb-3 fade-up"><div class="flex items-center justify-between flex-wrap gap-2"><div class="flex items-center gap-2"><div class="w-9 h-9 bg-gradient-to-br from-indigo-500/12 to-violet-500/12 rounded-lg flex items-center justify-center text-lg border border-indigo-500/6">${h.os==='Windows'?'üñ•Ô∏è':'üì±'}</div><div><h3 class="font-bold text-white text-xs">${h.brand||'PC'}</h3><p class="text-[9px] text-slate-400">${h.os||''} ${h.osVer||''} ¬∑ ${h.arch||''} ¬∑ ${h.cores||'?'}C${h.ram?' ¬∑ '+h.ram+'GB':''}</p><p class="text-[7px] text-slate-600 mt-0.5">${h.gpuBrand||''} ${h.gpuTier?'('+h.gpuTier+')':''} ¬∑ ${h.browser||''} ¬∑ ${h.cpuClass||''}</p></div></div>${h.battery?`<div class="stat px-2 py-1 flex items-center gap-1"><span class="text-xs">${h.charging?'üîå':'üîã'}</span><span class="text-[9px] font-bold ${h.batteryLevel<20?'text-red-400':'text-emerald-400'}">${h.batteryLevel}%</span></div>`:''}</div></div>
<div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3"><div class="card p-2.5 flex justify-center" id="d-cpu">${gauge(S.mon.cpu,'#10b981','CPU',S.mon.cpu+'%',80)}</div><div class="card p-2.5 flex justify-center" id="d-ram">${gauge(S.mon.ram,'#6366f1','RAM',S.mon.ram+'%',80)}</div><div class="card p-2.5 flex justify-center" id="d-temp">${gauge(S.mon.temp,'#10b981','TEMP',S.mon.temp+'¬∞C',80)}</div><div class="card p-2.5 flex flex-col items-center justify-center"><p class="text-lg mb-0.5">üåÄ</p><p class="font-black text-white text-base" id="d-fan">${S.mon.rpm}</p><p class="text-[7px] text-slate-600">RPM</p></div></div>
<div class="grid grid-cols-3 md:grid-cols-6 gap-1.5 mb-3">${[['monitor','üìä','Monitor'],['fans','üåÄ','Fans'],['performance','‚ö°','Rendimiento'],['gaming','üéÆ','Gaming'],['makeapp','üì¶','Crear App'],['cleanup','üßπ','Limpieza']].map(([id,ic,n])=>`<div class="qa-btn" onclick="go('${id}')"><p class="text-sm mb-0.5">${ic}</p><p class="text-[8px] font-semibold text-slate-400">${n}</p></div>`).join('')}</div>
<div class="grid md:grid-cols-2 gap-2.5 mb-3"><div class="card p-3">${hdr('üöÄ','Presets R√°pidos','1 clic')}<div class="space-y-1">${[['balanced','‚öñÔ∏è','Equilibrado','Uso diario','üåÄ Equilibrado'],['max','üî•','M√°x Rendimiento','100% potencia','üåÄ Rendimiento'],['privacy','üõ°Ô∏è','Privacidad','Sin telemetr√≠a','üåÄ Equilibrado'],['silent','ü§´','Silencioso','Fans m√≠nimo','üåÄ Silencioso'],['battery','üîã','Ahorro Bater√≠a','M√°xima duraci√≥n','üåÄ Silencioso']].map(([id,ic,n,d,fan])=>`<button onclick="applyPreset('${id}')" class="preset-btn group"><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-sm">${ic}</span><div><p class="font-bold text-white text-[10px]">${n}</p><p class="text-[7px] text-slate-600">${d} ¬∑ <span class="text-indigo-400">${fan}</span></p></div></div><svg class="w-3 h-3 text-slate-700 group-hover:text-indigo-400 transition-colors" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7"/></svg></div></button>`).join('')}</div></div>
<div class="space-y-2"><div class="card p-3"><div class="bg-emerald-500/4 border border-emerald-500/6 rounded-lg p-2.5 text-center"><p class="text-2xl mb-0.5">üõ°Ô∏è</p><p class="font-bold text-emerald-400 text-[10px]">PROTEGIDO</p><p class="text-[7px] text-slate-500 mt-0.5">Defender <strong>nunca</strong> se modifica</p></div></div><div class="card p-2.5 border-l-2 border-l-amber-500/30"><div class="flex items-start gap-2"><span class="text-sm">‚ö†Ô∏è</span><div><h4 class="font-bold text-amber-300 text-[9px] mb-0.5">Antes de ejecutar</h4><ul class="text-[7px] text-slate-600 space-y-0.5"><li>‚Ä¢ Punto de restauraci√≥n auto</li><li>‚Ä¢ Ejecutar como Admin</li><li>‚Ä¢ Reinicio puede ser necesario</li></ul></div></div></div></div></div>
<div class="card p-3 text-center"><p class="text-[10px] text-slate-400 mb-2">Configura y luego:</p><div class="flex justify-center gap-2"><button onclick="quickExec()" class="btn btn-s px-4 py-1.5">‚ñ∂ Ejecutar</button><button onclick="openExport()" class="btn btn-p px-3 py-1.5">üì¶ Exportar</button></div><p class="text-[7px] text-slate-700 mt-1">${cCount} opciones configuradas</p></div>`;}

function pMon(){return`${hdr('üìä','Monitor del Sistema','M√©tricas en tiempo real')}<div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3"><div class="card p-2.5 flex justify-center" id="m-cpu">${gauge(S.mon.cpu,'#10b981','CPU',S.mon.cpu+'%',100)}</div><div class="card p-2.5 flex justify-center" id="m-ram">${gauge(S.mon.ram,'#6366f1','RAM',S.mon.ram+'%',100)}</div><div class="card p-2.5 flex justify-center" id="m-temp">${gauge(S.mon.temp,'#10b981','TEMP',S.mon.temp+'¬∞C',100)}</div><div class="card p-2.5 flex justify-center" id="m-disk">${gauge(S.mon.disk,'#8b5cf6','DISCO',S.mon.disk+'%',100)}</div></div>${divider('Historial')}<div class="grid md:grid-cols-3 gap-2 mb-3"><div class="card p-2.5"><p class="text-[7px] text-slate-500 mb-1 font-semibold">CPU</p><div id="m-hist-cpu">${miniChart(S.hist.cpu,'#10b981',140,35)}</div></div><div class="card p-2.5"><p class="text-[7px] text-slate-500 mb-1 font-semibold">RAM</p><div id="m-hist-ram">${miniChart(S.hist.ram,'#6366f1',140,35)}</div></div><div class="card p-2.5"><p class="text-[7px] text-slate-500 mb-1 font-semibold">Temp</p><div id="m-hist-temp">${miniChart(S.hist.temp,'#f59e0b',140,35)}</div></div></div><div class="grid grid-cols-2 md:grid-cols-3 gap-2"><div class="stat p-2 flex items-center gap-2"><span class="text-base">üåÄ</span><div><p class="text-[7px] text-slate-600">Fan</p><p class="font-bold text-white text-sm" id="m-rpm">${S.mon.rpm} RPM</p></div></div><div class="stat p-2 flex items-center gap-2"><span class="text-base">‚è±Ô∏è</span><div><p class="text-[7px] text-slate-600">Uptime</p><p class="font-bold text-white text-sm">${S.mon.up}</p></div></div><div class="stat p-2 flex items-center gap-2"><span class="text-base">üåê</span><div><p class="text-[7px] text-slate-600">Red</p><p class="font-bold text-white text-sm">${S.mon.net} MB/s</p></div></div></div>`;}

// ==================== VENTILADORES ====================
function pFans(){const fp=S.fan.profile,cp=S.fan.profiles[fp],pn={silent:'Silencioso',balanced:'Equilibrado',performance:'Rendimiento',custom:'Personalizado'};return`${hdr('üåÄ','Control de Ventiladores','Perfiles independientes con curvas propias')}<div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3"><div class="stat p-2.5 text-center"><p class="text-[7px] text-slate-600 mb-0.5">RPM</p><p class="text-lg font-black text-white" id="f-rpm">${S.mon.rpm}</p></div><div class="stat p-2.5 text-center"><p class="text-[7px] text-slate-600 mb-0.5">Temp</p><p class="text-lg font-black text-white" id="f-temp">${S.mon.temp}¬∞C</p></div><div class="stat p-2.5 text-center"><p class="text-[7px] text-slate-600 mb-0.5">Perfil</p><p class="text-sm font-black text-indigo-400">${pn[fp]}</p></div><div class="stat p-2.5 text-center"><p class="text-[7px] text-slate-600 mb-0.5">Rango</p><p class="text-sm font-black text-white">${cp.min}‚Äì${cp.max}%</p></div></div><div class="grid grid-cols-2 md:grid-cols-4 gap-1.5 mb-3">${['silent','balanced','performance','custom'].map(p=>{const d={silent:{n:'Silencioso',a:'spin-s',ic:'ü§´',presets:'ü§´ Silencioso ¬∑ üîã Bater√≠a'},balanced:{n:'Equilibrado',a:'spin-m',ic:'‚öñÔ∏è',presets:'‚öñÔ∏è Equilibrado ¬∑ üõ°Ô∏è Privacidad'},performance:{n:'Rendimiento',a:'spin-f',ic:'üî•',presets:'üî• M√°x Rendimiento'},custom:{n:'Custom',a:'spin-m',ic:'üõ†Ô∏è',presets:'Manual'}}[p],pr=S.fan.profiles[p];return`<button onclick="setFanP('${p}')" class="card p-2.5 text-center cursor-pointer ${fp===p?'!border-indigo-500/20':''}"><div class="text-base mb-0.5">${fp===p?'<span class="inline-block '+d.a+'">üåÄ</span>':d.ic}</div><p class="font-bold text-white text-[9px]">${d.n}</p><p class="text-[7px] text-indigo-400 mono mt-0.5">${pr.min}‚Äì${pr.max}%</p>${fp===p?'<p class="text-[6px] text-emerald-400 mt-0.5 font-bold">‚óè ACTIVO</p>':''}<p class="text-[5px] text-slate-600 mt-0.5">Presets: ${d.presets}</p></button>`;}).join('')}</div>${divider('Curva de '+pn[fp])}<div class="card p-3 mb-2.5"><div class="flex items-center justify-between mb-2"><div><p class="font-semibold text-white text-[10px]">Temp ‚Üí Velocidad</p><p class="text-[7px] text-slate-600">Editando: <strong class="text-indigo-400">${pn[fp]}</strong></p></div><button onclick="resetFC()" class="btn btn-g px-2 py-1 text-[7px]">‚Ü∫ Reset</button></div><div class="fan-box p-2" style="height:160px" id="fanWrap"><canvas id="fanCanvas" width="500" height="150"></canvas></div><div class="grid grid-cols-5 gap-1 mt-2" id="fanInputs"></div></div>${divider('Config de '+pn[fp])}${grid(`${sli('fan_min_'+fp,'Vel. m√≠n ('+pn[fp]+')','RPM m√≠nimas',0,50,cp.min,'%')}${sli('fan_max_'+fp,'Vel. m√°x ('+pn[fp]+')','RPM m√°ximas',50,100,cp.max,'%')}${tog('fan_smart','Modo inteligente','Auto seg√∫n carga',true,'low')}`)}`;}
function setFanP(p){S.fan.profile=p;track('fan_profile',p);render('fans');}
function resetFC(){const def={silent:[{t:30,s:8},{t:45,s:18},{t:60,s:30},{t:75,s:50},{t:90,s:65}],balanced:[{t:30,s:10},{t:45,s:25},{t:60,s:50},{t:75,s:80},{t:90,s:100}],performance:[{t:30,s:30},{t:45,s:50},{t:60,s:70},{t:75,s:90},{t:90,s:100}],custom:[{t:30,s:10},{t:45,s:25},{t:60,s:50},{t:75,s:80},{t:90,s:100}]};S.fan.profiles[S.fan.profile].curve=def[S.fan.profile]||def.balanced;render('fans');}
function initFanCanvas(){const c=document.getElementById('fanCanvas'),w=document.getElementById('fanWrap');if(!c||!w)return;c.width=w.clientWidth-16;c.height=150;drawFC();updFI();}
function drawFC(){const c=document.getElementById('fanCanvas');if(!c)return;const ctx=c.getContext('2d'),w=c.width,h=c.height,p=28;ctx.clearRect(0,0,w,h);ctx.strokeStyle='rgba(99,102,241,0.02)';ctx.lineWidth=0.5;for(let i=0;i<=10;i++){const x=p+(w-p*2)*i/10;ctx.beginPath();ctx.moveTo(x,4);ctx.lineTo(x,h-p);ctx.stroke();const y=4+(h-p-4)*i/10;ctx.beginPath();ctx.moveTo(p,y);ctx.lineTo(w-p,y);ctx.stroke();}ctx.fillStyle='#252d3d';ctx.font='7px Inter';for(let t=30;t<=90;t+=15){const x=p+(t-20)/80*(w-p*2);ctx.fillText(t+'¬∞',x-5,h-p+11);}for(let s=0;s<=100;s+=25){const y=h-p-s/100*(h-p-4);ctx.fillText(s+'%',1,y+3);}const pts=S.fan.curve.map(pt=>({x:p+(pt.t-20)/80*(w-p*2),y:h-p-pt.s/100*(h-p-4)}));ctx.beginPath();ctx.moveTo(pts[0].x,h-p);pts.forEach(pt=>ctx.lineTo(pt.x,pt.y));ctx.lineTo(pts[pts.length-1].x,h-p);ctx.closePath();const g=ctx.createLinearGradient(0,0,0,h);g.addColorStop(0,'rgba(99,102,241,0.05)');g.addColorStop(1,'rgba(99,102,241,0)');ctx.fillStyle=g;ctx.fill();ctx.beginPath();pts.forEach((pt,i)=>i===0?ctx.moveTo(pt.x,pt.y):ctx.lineTo(pt.x,pt.y));ctx.strokeStyle='#6366f1';ctx.lineWidth=1.5;ctx.stroke();pts.forEach((pt,i)=>{ctx.beginPath();ctx.arc(pt.x,pt.y,3.5,0,Math.PI*2);ctx.fillStyle='#6366f1';ctx.fill();ctx.strokeStyle='#c7d2fe';ctx.lineWidth=1;ctx.stroke();ctx.fillStyle='#c7d2fe';ctx.font='bold 6px Inter';ctx.fillText(S.fan.curve[i].t+'¬∞‚Üí'+S.fan.curve[i].s+'%',pt.x-12,pt.y-7);});}
function updFI(){const d=document.getElementById('fanInputs');if(!d)return;d.innerHTML=S.fan.curve.map((pt,i)=>`<div class="stat p-1 text-center"><p class="text-[6px] text-slate-700 mb-0.5">P${i+1}</p><div class="flex items-center gap-0.5 justify-center"><input type="number" value="${pt.t}" min="20" max="100" class="w-7 bg-slate-900/80 border border-slate-700/30 rounded px-0.5 py-0.5 text-[7px] text-center text-white focus:outline-none focus:border-indigo-500" onchange="updFP(${i},'t',this.value)"><span class="text-slate-700 text-[5px]">‚Üí</span><input type="number" value="${pt.s}" min="0" max="100" class="w-7 bg-slate-900/80 border border-slate-700/30 rounded px-0.5 py-0.5 text-[7px] text-center text-white focus:outline-none focus:border-indigo-500" onchange="updFP(${i},'s',this.value)"><span class="text-slate-700 text-[5px]">%</span></div></div>`).join('');}
function updFP(i,k,v){S.fan.profiles[S.fan.profile].curve[i][k]=parseInt(v);track('fan_curve',S.fan.profile);drawFC();updFI();}

// ==================== SECCIONES DE OPTIMIZACI√ìN ====================
function pPerf(){return`${hdr('‚ö°','Rendimiento',S.hw.brand+' ¬∑ '+S.hw.cores+' n√∫cleos')}${grid(`${tog('p_sysmain','Desactivar SysMain','Libera RAM',true,'med')}${tog('p_prefetch','Desactivar Prefetch','Reduce escrituras',false,'med')}${tog('p_indexing','Sin Windows Search','Reduce CPU',true,'low')}${tog('p_visual','Optimizar efectos','Sin animaciones',true,'low')}${tog('p_transparency','Sin transparencias','Reduce GPU',true,'low')}${tog('p_startup_delay','Sin delay inicio','Men√∫ r√°pido',true,'low')}${tog('p_menu_delay','Men√∫s r√°pidos','Contextuales √°giles',true,'low')}${tog('p_tips','Sin tips Windows','Sin notif extras',true,'low')}${tog('p_cpu_priority','Priorizar ventana','M√°s CPU al activo',true,'low')}${tog('p_ntfs_last','Sin acceso NTFS','Reduce escrituras',true,'low')}${tog('p_core_parking','Sin Core Parking','Todos los n√∫cleos',false,'med')}${tog('p_timer_res','Alta res timer','Mejor precisi√≥n',false,'med')}`)}`;} function pClean(){
const sizeMap={c_temp:850,c_recycle:1200,c_update:3500,c_thumb:120,c_logs:200,c_dns:2,c_bloatware:2800,c_delivery:500,c_error:150,c_prefetch:80,c_font_cache:30,c_installer:1500,c_downloads:500,c_browser:600,c_cortana:50};
const sizeLabels={c_temp:'~850 MB',c_recycle:'~1.2 GB',c_update:'~3.5 GB',c_thumb:'~120 MB',c_logs:'~200 MB',c_dns:'~2 MB',c_bloatware:'~2.8 GB',c_delivery:'~500 MB',c_error:'~150 MB',c_prefetch:'~80 MB',c_font_cache:'~30 MB',c_installer:'~1.5 GB',c_downloads:'Variable',c_browser:'~600 MB',c_cortana:'~50 MB'};
let totalMB=0;Object.entries(sizeMap).forEach(([k,v])=>{if(S.toggles[k])totalMB+=v;});
const total=totalMB>=1000?(totalMB/1000).toFixed(1)+' GB':totalMB+' MB';
const activeC=Object.keys(sizeMap).filter(k=>S.toggles[k]).length;
function cTog(id,label,desc,def,risk){const sz=sizeLabels[id]||'';return tog(id,label,desc+' ¬∑ <span class="text-amber-400/80 font-semibold">'+sz+'</span>',def,risk);}
return`${hdr('üßπ','Limpieza Profunda','Libera espacio y mejora rendimiento')}
<div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3">
<div class="card p-2.5 text-center border-l-2 border-l-emerald-500/30"><p class="text-[7px] text-slate-600 mb-0.5">Espacio a liberar</p><p class="text-base font-black text-emerald-400" id="cl-total">${total}</p><p class="text-[6px] text-slate-700">estimado</p></div>
<div class="card p-2.5 text-center"><p class="text-[7px] text-slate-600 mb-0.5">Opciones activas</p><p class="text-base font-black text-indigo-400">${activeC}</p><p class="text-[6px] text-slate-700">de ${Object.keys(sizeMap).length}</p></div>
<div class="card p-2.5 text-center"><p class="text-[7px] text-slate-600 mb-0.5">Riesgo</p><p class="text-base font-black ${activeC>10?'text-amber-400':activeC>5?'text-emerald-400':'text-slate-400'}">${activeC>10?'Medio':activeC>5?'Bajo':'M√≠nimo'}</p><p class="text-[6px] text-slate-700">nivel actual</p></div>
<div class="card p-2.5 text-center cursor-pointer hover:border-emerald-500/15" onclick="cleanQuick()"><p class="text-lg mb-0.5">üöÄ</p><p class="text-[9px] font-bold text-emerald-400">Limpieza R√°pida</p><p class="text-[6px] text-slate-700">activa lo seguro</p></div>
</div>
<div class="grid grid-cols-3 gap-1.5 mb-3">
<button onclick="cleanAll()" class="btn btn-s py-1.5 w-full text-[9px]">üßπ Seleccionar Todo</button>
<button onclick="cleanNone()" class="btn btn-d py-1.5 w-full text-[9px]">‚ùå Deseleccionar</button>
<button onclick="cleanSafe()" class="btn btn-p py-1.5 w-full text-[9px]">üõ°Ô∏è Solo Seguros</button>
</div>
${divider('üìÇ Archivos Temporales')}
${grid(`${cTog('c_temp','Archivos temporales','%TEMP% y Windows\\\\Temp',true,'low')}${cTog('c_recycle','Vaciar papelera','Archivos eliminados',true,'low')}${cTog('c_downloads','Descargas antiguas','Archivos >30 d√≠as',false,'med')}${cTog('c_prefetch','Prefetch','Datos de precarga',false,'med')}`)}
${divider('üíæ Cach√© del Sistema')}
${grid(`${cTog('c_update','Cach√© de Updates','Updates ya instaladas',true,'med')}${cTog('c_thumb','Miniaturas','Thumbnails de im√°genes',true,'low')}${cTog('c_dns','Cach√© DNS','Resoluci√≥n de nombres',true,'low')}${cTog('c_font_cache','Cach√© de fuentes','Fuentes del sistema',false,'low')}${cTog('c_delivery','Delivery Optimization','Distribuci√≥n P2P updates',true,'low')}${cTog('c_browser','Cach√© navegadores','Chrome, Edge, Firefox',false,'med')}`)}
${divider('üìã Registros y Reportes')}
${grid(`${cTog('c_logs','Logs del sistema','Event Viewer antiguos',true,'low')}${cTog('c_error','Reportes de error','Windows Error Reports',true,'low')}${cTog('c_cortana','Datos de Cortana','Historial de b√∫squeda',true,'low')}`)}
${divider('‚ö†Ô∏è Limpieza Avanzada')}
<div class="card p-2 mb-2 border-l-2 border-l-red-500/30"><p class="text-[8px] text-red-200/70">‚ö†Ô∏è Estas opciones eliminan componentes. <strong>Crear punto de restauraci√≥n primero.</strong></p></div>
${grid(`${cTog('c_bloatware','Remover bloatware','Apps preinstaladas de f√°brica',false,'high')}${cTog('c_installer','Windows Installer','Instaladores hu√©rfanos',false,'high')}`)}
${divider('üìä Desglose de Espacio')}
<div class="card p-3"><div class="space-y-1">${Object.entries(sizeMap).map(([id,mb])=>{const active=S.toggles[id];const pct=Math.min(100,mb/3500*100);const label=id.replace('c_','').replace(/_/g,' ');return`<div class="flex items-center gap-2 ${active?'opacity-100':'opacity-30'}"><span class="text-[7px] text-slate-400 w-20 truncate capitalize">${label}</span><div class="flex-1 h-1.5 bg-slate-800/50 rounded-full overflow-hidden"><div class="h-full rounded-full transition-all duration-300 ${active?'bg-emerald-500':'bg-slate-700'}" style="width:${active?pct:0}%"></div></div><span class="text-[7px] mono ${active?'text-emerald-400':'text-slate-700'} w-14 text-right">${sizeLabels[id]}</span></div>`;}).join('')}</div><div class="mt-2 pt-2 border-t border-white/[0.03] flex items-center justify-between"><span class="text-[8px] text-slate-500 font-semibold">Total estimado</span><span class="text-[10px] font-black text-emerald-400">${total}</span></div></div>`;}
function cleanQuick(){const safe=['c_temp','c_recycle','c_thumb','c_dns','c_logs','c_error','c_delivery','c_cortana','c_font_cache'];safe.forEach(k=>{S.toggles[k]=true;track(k,true);});notify('üöÄ Limpieza r√°pida activada','#10b981');render('cleanup');}
function cleanAll(){Object.keys({c_temp:1,c_recycle:1,c_update:1,c_thumb:1,c_logs:1,c_dns:1,c_bloatware:1,c_delivery:1,c_error:1,c_prefetch:1,c_font_cache:1,c_installer:1,c_downloads:1,c_browser:1,c_cortana:1}).forEach(k=>{S.toggles[k]=true;track(k,true);});notify('üßπ Todo seleccionado','#6366f1');render('cleanup');}
function cleanNone(){Object.keys({c_temp:1,c_recycle:1,c_update:1,c_thumb:1,c_logs:1,c_dns:1,c_bloatware:1,c_delivery:1,c_error:1,c_prefetch:1,c_font_cache:1,c_installer:1,c_downloads:1,c_browser:1,c_cortana:1}).forEach(k=>{S.toggles[k]=false;track(k,false);});notify('‚ùå Todo deseleccionado','#ef4444');render('cleanup');}
function cleanSafe(){Object.keys({c_temp:1,c_recycle:1,c_update:1,c_thumb:1,c_logs:1,c_dns:1,c_bloatware:1,c_delivery:1,c_error:1,c_prefetch:1,c_font_cache:1,c_installer:1,c_downloads:1,c_browser:1,c_cortana:1}).forEach(k=>{S.toggles[k]=false;track(k,false);});['c_temp','c_recycle','c_thumb','c_dns','c_logs','c_error','c_delivery','c_cortana','c_font_cache'].forEach(k=>{S.toggles[k]=true;track(k,true);});notify('üõ°Ô∏è Solo opciones seguras','#10b981');render('cleanup');}
function pNet(){return`${hdr('üåê','Red','Optimiza conexi√≥n')}${grid(`${tog('n_flush','Flush DNS','Limpia cach√©',true,'low')}${tog('n_winsock','Reset Winsock','Restablece config',false,'med')}${tog('n_tcpip','Reset TCP/IP','Reinicia pila',false,'med')}${tog('n_nagle','Sin Nagle','Reduce latencia',false,'med')}${tog('n_qos','Sin QoS','Libera ancho banda',true,'low')}${tog('n_autotuning','Sin Auto-Tuning','Estabiliza WiFi',false,'med')}`)}${divider('DNS')}${grid(`${sel('n_dns','DNS','Proveedor',[{v:'default',l:'ISP'},{v:'google',l:'Google 8.8.8.8'},{v:'cloudflare',l:'Cloudflare 1.1.1.1'},{v:'quad9',l:'Quad9'}],'cloudflare')}${sel('n_adapter','Adaptador','Conexi√≥n',[{v:'wifi',l:'Wi-Fi'},{v:'ethernet',l:'Ethernet'}],'wifi')}`)}`;} function pPow(){return`${hdr('üîã','Energ√≠a','Plan'+(S.hw.battery?' ¬∑ '+S.hw.batteryLevel+'%':''))}${grid(`${tog('pw_high','Alto Rendimiento','M√°xima energ√≠a',true,'low')}${tog('pw_hibernate','Sin hibernaci√≥n','Libera ~4GB',true,'low')}${tog('pw_fast_start','Sin inicio r√°pido','Arranque limpio',false,'low')}${tog('pw_usb','Sin USB Suspend','No apagar USB',true,'low')}${tog('pw_disk','Nunca apagar disco','Sin lag',true,'low')}${tog('pw_cpu_max','CPU 100%','M√°x constante',false,'med')}`)}${divider('Tiempos')}${grid(`${sli('pw_screen_ac','Pantalla AC','Min apagar',0,60,15,' min')}${sli('pw_sleep_ac','Suspender AC','0=nunca',0,120,30,' min')}`)}`;} function pStart(){return`${hdr('üöÄ','Arranque','Programas de inicio')}${grid(`${tog('b_delay','Sin delay apps','Inicio r√°pido',true,'low')}${tog('b_numlock','NumLock auto','Activa al inicio',true,'low')}${tog('b_onedrive','Sin OneDrive','No abrir',true,'low')}${tog('b_teams','Sin Teams','No abrir',true,'low')}${tog('b_edge','Sin Edge','No precargar',true,'low')}${tog('b_spotify','Sin Spotify','No abrir',true,'low')}${tog('b_discord','Sin Discord','No abrir',false,'low')}${tog('b_cortana','Sin Cortana','No iniciar',true,'low')}${tog('b_adobe','Sin Adobe upd','Sin actualizador',true,'low')}${tog('b_skype','Sin Skype','No abrir',true,'low')}`)}`;} function pGame(){return`${hdr('üéÆ','Gaming','FPS y latencia')}${grid(`${tog('g_mode','Game Mode','Prioriza juegos',true,'low')}${tog('g_dvr','Sin Game DVR','Sin grabaci√≥n',true,'low')}${tog('g_fullscreen','Sin opt fullscreen','Mejora FPS',true,'low')}${tog('g_mouse','Sin aceleraci√≥n','Mouse 1:1',true,'low')}${tog('g_nagle','Sin Nagle gaming','Reduce ping',true,'med')}${tog('g_hpet','Sin HPET','Mejor rendimiento',false,'high')}${tog('g_throttle','Sin Throttling','CPU no baja',true,'low')}${tog('g_notif','Sin notificaciones','Sin popups',true,'low')}${tog('g_xbox','Sin Xbox Bar','Libera recursos',true,'low')}${tog('g_standby','Limpiar RAM','Libera peri√≥dicamente',false,'med')}`)}${divider('GPU')}${grid(`${sel('g_gpu_sched','GPU Scheduling','HW scheduling',[{v:'off',l:'Off'},{v:'on',l:'On'}],'on')}${sel('g_gpu_mode','Modo GPU','Preferencia',[{v:'balanced',l:'Equilibrado'},{v:'high',l:'Alto rendimiento'}],'high')}`)}`;} function pKeys(){return`${hdr('‚å®Ô∏è','Keybinds','Clic y presiona teclas')}<div class="card p-2 mb-2.5 border-l-2 border-l-amber-500/30"><p class="text-[8px] text-amber-200/70">üí° Se exportan como <strong>AutoHotkey (.AHK)</strong></p></div>${divider('Sistema')}${grid(`${kb('k_screenshot','Screenshot','Captura','Win + Shift + S')}${kb('k_taskmgr','Task Manager','Admin tareas','Ctrl + Shift + Escape')}${kb('k_run','Ejecutar','Di√°logo','Win + R')}${kb('k_explorer','Explorador','Archivos','Win + E')}${kb('k_cmd','Terminal','CMD admin','Ctrl + Shift + T')}${kb('k_desktop','Escritorio','Mostrar','Win + D')}`)}${divider('Multimedia')}${grid(`${kb('k_vol_up','Vol +','Subir','Ctrl + Up')}${kb('k_vol_down','Vol -','Bajar','Ctrl + Down')}${kb('k_mute','Mute','Toggle','Ctrl + M')}${kb('k_play','Play/Pausa','Media','Ctrl + Space')}`)}${divider('Apps')}${grid(`${kb('k_calc','Calculadora','Abrir','Ctrl + Alt + C')}${kb('k_notepad','Notepad','Bloc notas','Ctrl + Alt + N')}${kb('k_lock','Bloquear','Pantalla','Win + L')}${kb('k_browser','Navegador','Abrir','Ctrl + Alt + B')}`)}`;} function pVis(){return`${hdr('üé®','Visual','Apariencia')}${grid(`${tog('v_dark','Modo oscuro','Tema oscuro',true,'low')}${tog('v_dark_apps','Oscuro apps','Apps oscuras',true,'low')}${tog('v_no_anim','Sin animaciones','M√°s r√°pido',true,'low')}${tog('v_no_trans','Sin transparencias','Reduce GPU',true,'low')}${tog('v_no_shadow','Sin sombras','Sin sombras ventanas',false,'low')}${tog('v_ext','Extensiones','Archivos visibles',true,'low')}${tog('v_smooth_font','Suavizado fuentes','ClearType',true,'low')}${tog('v_wallpaper','Wallpaper HD','Sin compresi√≥n',true,'low')}`)}${divider('Cursor')}${grid(`${sli('v_cursor','Velocidad cursor','Mouse',1,20,10,'')}${tog('v_no_accel','Sin aceleraci√≥n','1:1 gaming',false,'low')}`)}`;} function pTask(){return`${hdr('üìå','Taskbar','Barra de tareas')}${grid(`${tog('t_search','Ocultar b√∫squeda','Sin barra',true,'low')}${tog('t_taskview','Sin Task View','Sin bot√≥n',true,'low')}${tog('t_widgets','Sin Widgets','Sin widgets',true,'low')}${tog('t_chat','Sin Chat','Sin √≠cono',true,'low')}${tog('t_copilot','Sin Copilot','Sin bot√≥n',true,'low')}${tog('t_small','Iconos peque√±os','Compacta',false,'low')}${tog('t_never_combine','No combinar','Separadas',false,'low')}`)}${divider('Posici√≥n')}${grid(`${sel('t_align','Alineaci√≥n','Iconos',[{v:'center',l:'Centro'},{v:'left',l:'Izquierda'}],'left')}`)}`;} function pExp(){return`${hdr('üìÅ','Explorador','Archivos')}${grid(`${tog('e_ext','Extensiones','Muestra extensiones',true,'low')}${tog('e_hidden','Ocultos','Muestra ocultos',true,'low')}${tog('e_thispc','Este PC','No Recientes',true,'low')}${tog('e_classic','Men√∫ cl√°sico','Sin "M√°s opciones"',true,'low')}${tog('e_no_recent','Sin recientes','No recientes',true,'low')}${tog('e_full_path','Ruta completa','En barra',true,'low')}${tog('e_compact','Vista compacta','Menos espacio',true,'low')}${tog('e_no_ads','Sin anuncios','Sin tips',true,'low')}`)}`;} function pSnd(){return`${hdr('üîä','Sonido','Audio')}${grid(`${tog('s_no_startup','Sin sonido inicio','Silencia inicio',true,'low')}${tog('s_no_notif','Sin sonido notif','Silenciosas',false,'low')}${tog('s_exclusive','Exclusivo off','Apps no toman audio',false,'med')}${tog('s_comms','Sin reducci√≥n','No baja vol en llamadas',true,'low')}${tog('s_loudness','Ecualizaci√≥n','Normaliza vol',false,'low')}`)}${divider('Formato')}${grid(`${sli('s_vol','Volumen default','Vol al iniciar',0,100,50,'%')}${sel('s_format','Formato','Calidad',[{v:'16_44',l:'16bit 44.1kHz'},{v:'16_48',l:'16bit 48kHz'},{v:'24_48',l:'24bit 48kHz'},{v:'24_96',l:'24bit 96kHz'}],'16_48')}`)}`;} function pPriv(){return`${hdr('üõ°Ô∏è','Privacidad','Telemetr√≠a')}<div class="card p-2 mb-2.5 border-l-2 border-l-emerald-500/30"><p class="text-[8px] text-emerald-200/70">‚úÖ <strong>Defender NO se toca.</strong></p></div>${grid(`${tog('pr_telemetry','Sin telemetr√≠a','Bloquea diagn√≥sticos',true,'med')}${tog('pr_cortana','Sin Cortana','Deshabilita',true,'low')}${tog('pr_activity','Sin historial','No guardar actividad',true,'low')}${tog('pr_ad_id','Sin ID publicidad','Sin anuncios',true,'low')}${tog('pr_location','Sin ubicaci√≥n','No compartir',true,'low')}${tog('pr_diag','Diagn√≥stico m√≠n','Solo obligatorios',true,'low')}${tog('pr_feedback','Sin feedback','No pedir opiniones',true,'low')}${tog('pr_suggestions','Sin sugerencias','Sin apps sugeridas',true,'low')}${tog('pr_lockscreen','Sin tips lock','Sin anuncios lock',true,'low')}${tog('pr_timeline','Sin Timeline','Sin l√≠nea tiempo',true,'low')}${tog('pr_clipboard','Sin sync clip','No sincronizar',true,'low')}${tog('pr_input','Sin datos escrit','No enviar typing',true,'low')}`)}`;} function pSvc(){return`${hdr('‚öôÔ∏è','Servicios','Desactiva innecesarios')}<div class="card p-2 mb-2.5 border-l-2 border-l-red-500/30"><p class="text-[8px] text-red-200/70">‚ö†Ô∏è <strong>Defender NO incluido.</strong></p></div>${grid(`${tog('sv_diagtrack','DiagTrack','Telemetr√≠a',true,'med')}${tog('sv_dmwap','dmwappush','WAP push',true,'med')}${tog('sv_sysmain','SysMain','Superfetch',true,'med')}${tog('sv_wsearch','Windows Search','Indexaci√≥n',true,'med')}${tog('sv_xbox','Servicios Xbox','Auth, Save',true,'low')}${tog('sv_maps','Mapas','Mapas offline',true,'low')}${tog('sv_fax','Fax','Servicio fax',true,'low')}${tog('sv_print','Impresi√≥n','Si usas impresora',false,'med')}${tog('sv_remote','Reg. remoto','Acceso remoto',true,'low')}${tog('sv_phone','PhoneSvc','Tel√©fono',true,'low')}${tog('sv_retail','RetailDemo','Demo tienda',true,'low')}${tog('sv_wallet','Wallet','Billetera',true,'low')}`)}`;} function pUpd(){return`${hdr('üîÑ','Updates','Actualizaciones')}${grid(`${tog('wu_no_restart','Sin reinicio auto','Sin permiso',true,'low')}${tog('wu_no_driver','Sin upd drivers','No toca drivers',false,'med')}${tog('wu_no_feature','Sin Feature Upd','Bloquea grandes',false,'high')}${tog('wu_metered','Conexi√≥n medida','Reduce descargas',false,'med')}${tog('wu_no_peer','Sin P2P','No compartir',true,'low')}${tog('wu_notify','Solo notificar','No auto descargar',false,'med')}${tog('wu_no_store','Sin auto Store','Store no actualiza',false,'low')}`)}${divider('Horas')}${grid(`${sli('wu_start','Hora inicio','Horas activas',0,23,8,'h')}${sli('wu_end','Hora fin','Horas activas',0,23,23,'h')}`)}`;} function pSec(){return`${hdr('üîí','Seguridad','Configuraci√≥n')}<div class="bg-emerald-500/4 border border-emerald-500/6 rounded-lg p-2 mb-2.5 flex items-center gap-2"><span class="text-lg">üõ°Ô∏è</span><div><p class="font-bold text-emerald-400 text-[10px]">Defender PROTEGIDO</p><p class="text-[7px] text-slate-500">NO se modifica.</p></div></div>${grid(`${tog('sec_smb1','Sin SMBv1','Protocolo antiguo',true,'low')}${tog('sec_remote','Sin Escritorio Rem.','Desactiva',true,'low')}${tog('sec_assist','Sin Asistencia','Desactiva',true,'low')}${tog('sec_autoplay','Sin AutoPlay','No ejecutar USB',true,'low')}${tog('sec_netbios','Sin NetBIOS','Legacy inseguro',true,'low')}${tog('sec_null','Sesiones nulas','Bloquea an√≥nimo',true,'low')}${tog('sec_lm','Sin LM Hash','Hash seguro',true,'low')}${tog('sec_wpad','Sin WPAD','Sin proxy auto',true,'low')}`)}`;} function pMaint(){return`${hdr('üîß','Mantenimiento','Reparaci√≥n')}${grid(`${tog('m_sfc','SFC /scannow','Repara archivos',true,'low')}${tog('m_dism','DISM Restore','Repara imagen',true,'low')}${tog('m_chkdsk','Verificar disco','Errores disco',false,'med')}${tog('m_defrag','Optimizar disco','Desfrag/TRIM',true,'low')}${tog('m_restore','Punto restauraci√≥n','Antes de cambios',true,'low')}${tog('m_logs','Limpiar logs','Registros eventos',false,'low')}${tog('m_store','Reset Store','Repara Store',false,'low')}${tog('m_network','Reset red','Reinstala adaptadores',false,'med')}${tog('m_winsxs','Limpiar WinSxS','Componentes obsoletos',false,'med')}${tog('m_icon','Rebuild iconos','Iconos corruptos',false,'low')}`)}`;} function pTerm(){return`${hdr('üíª','Terminal','Comandos')}<div class="term mb-2.5"><div class="bg-[rgba(12,15,24,0.9)] px-3 py-1.5 flex items-center gap-1.5 border-b border-white/[0.03]"><div class="flex gap-1"><div class="w-2 h-2 bg-red-500 rounded-full"></div><div class="w-2 h-2 bg-yellow-500 rounded-full"></div><div class="w-2 h-2 bg-green-500 rounded-full"></div></div><span class="text-slate-500 text-[8px] ml-1.5 mono">PCTuner</span></div><div class="term-body" id="tBody"><p class="text-emerald-400">PCTuner Pro v6 ‚Äî ${S.hw.brand} ${S.hw.os}</p><p class="text-slate-700 text-[7px]">Simulaci√≥n. Exporta para ejecutar real.</p><p class="text-emerald-400 mt-1">C:\\> <span class="animate-pulse">_</span></p></div></div><div class="grid grid-cols-2 md:grid-cols-3 gap-1.5">${[['sfc /scannow','üîç','SFC'],['ipconfig /flushdns','üåê','DNS'],['systeminfo','üíª','Info'],['cleanmgr','üßπ','Limpiar'],['powercfg /batteryreport','üîã','Bater√≠a'],['netsh wlan show profiles','üì°','WiFi']].map(([cmd,ic,n])=>`<button onclick="tRun('${cmd}')" class="card p-2 text-center cursor-pointer hover:border-indigo-500/12"><p class="text-sm">${ic}</p><p class="font-bold text-white text-[8px]">${n}</p></button>`).join('')}</div>`;}
function tRun(cmd){const el=document.getElementById('tBody');if(!el)return;const o={'sfc /scannow':'[========= 100% =========]\nOK.','ipconfig /flushdns':'Cach√© DNS vaciada.','systeminfo':`${S.hw.brand}\n${S.hw.os} ${S.hw.osVer||''} ¬∑ ${S.hw.arch}\n${S.hw.cores} n√∫cleos ¬∑ ${S.hw.ram||'?'}GB`,'cleanmgr':'Liberado: 2.75 GB','powercfg /batteryreport':`Bater√≠a: ${S.hw.battery?S.hw.batteryLevel+'%':'N/A'}`,'netsh wlan show profiles':'WiFi:\n  MiRed_5G'};const out=o[cmd]||'OK';el.innerHTML+=`<p class="text-cyan-400 mt-1">C:\\> <span class="text-white">${cmd}</span></p>`;out.split('\n').forEach((l,i)=>{setTimeout(()=>{el.innerHTML+=`<p class="text-emerald-400 fade-up">${l}</p>`;el.scrollTop=el.scrollHeight;},i*60);});}
function pProf(){const saved=JSON.parse(localStorage.getItem('pct6')||'{}'),names=Object.keys(saved);return`${hdr('üíæ','Perfiles','Guardar y cargar')}<div class="grid md:grid-cols-2 gap-2 mb-3"><div class="card p-3"><h4 class="font-bold text-white text-[10px] mb-1.5">üíæ Guardar</h4><input type="text" id="pName" placeholder="Nombre..." class="w-full bg-slate-900/80 border border-slate-700/30 rounded-lg px-3 py-1.5 text-[10px] mb-1.5 focus:border-indigo-500 focus:outline-none text-white placeholder-slate-700"><button onclick="saveProf()" class="w-full btn btn-p py-1.5">Guardar</button></div><div class="card p-3"><h4 class="font-bold text-white text-[10px] mb-1.5">üìÇ Import/Export</h4><div class="flex gap-1.5"><button onclick="expJSON()" class="flex-1 btn btn-s py-1.5">üì§ JSON</button><label class="flex-1 btn btn-p py-1.5 text-center cursor-pointer">üì• Import<input type="file" accept=".json" class="hidden" onchange="impJSON(event)"></label></div></div></div>${names.length?`${divider('Guardados')}<div class="section-grid stagger">${names.map(n=>`<div class="card p-2.5 flex items-center justify-between"><div><p class="font-semibold text-white text-[10px]">${n}</p><p class="text-[7px] text-slate-600">${Object.keys(saved[n].t||{}).length} opciones</p></div><div class="flex gap-1"><button onclick="loadProf('${n}')" class="btn btn-p px-2 py-1 text-[8px]">Cargar</button><button onclick="delProf('${n}')" class="btn btn-d px-1.5 py-1 text-[8px]">‚úï</button></div></div>`).join('')}</div>`:''}`;}
function saveProf(){const n=document.getElementById('pName')?.value?.trim();if(!n)return;const p=JSON.parse(localStorage.getItem('pct6')||'{}');p[n]={t:{...S.toggles},s:{...S.sliders},se:{...S.selects},k:{...S.keybinds},fp:JSON.parse(JSON.stringify(S.fan.profiles)),fan:S.fan.profile};localStorage.setItem('pct6',JSON.stringify(p));notify('‚úÖ Guardado','#10b981');render('profiles');}
function loadProf(n){const p=JSON.parse(localStorage.getItem('pct6')||'{}');if(!p[n])return;const d=p[n];Object.assign(S.toggles,d.t||{});Object.assign(S.sliders,d.s||{});Object.assign(S.selects,d.se||{});Object.assign(S.keybinds,d.k||{});if(d.fp)Object.assign(S.fan.profiles,JSON.parse(JSON.stringify(d.fp)));if(d.fan)S.fan.profile=d.fan;notify('‚úÖ Cargado','#10b981');render(S.page);}
function delProf(n){const p=JSON.parse(localStorage.getItem('pct6')||'{}');delete p[n];localStorage.setItem('pct6',JSON.stringify(p));notify('üóëÔ∏è Eliminado','#ef4444');render('profiles');}
function expJSON(){dl('pctuner_config.json',JSON.stringify({t:S.toggles,s:S.sliders,se:S.selects,k:S.keybinds,fp:S.fan.profiles,fan:S.fan.profile},null,2));}
function impJSON(ev){const f=ev.target.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{try{const d=JSON.parse(e.target.result);Object.assign(S.toggles,d.t||{});Object.assign(S.sliders,d.s||{});Object.assign(S.selects,d.se||{});Object.assign(S.keybinds,d.k||{});if(d.fp)Object.assign(S.fan.profiles,JSON.parse(JSON.stringify(d.fp)));if(d.fan)S.fan.profile=d.fan;notify('‚úÖ Importado','#10b981');render(S.page);}catch(e){notify('‚ùå Error','#ef4444');}};r.readAsText(f);}

// ==================== CREAR APP ====================
function pMakeApp(){return`${hdr('üì¶','Instalar PCTuner Pro','Instalador autom√°tico ‚Äî 1 clic')}
<div class="card p-4 mb-3 border-l-2 border-l-emerald-500/30 hover-glow"><div class="flex items-start gap-3"><div class="w-12 h-12 bg-gradient-to-br from-emerald-500/15 to-green-500/10 rounded-xl flex items-center justify-center text-2xl border border-emerald-500/10 flex-shrink-0">üöÄ</div><div><h4 class="font-bold text-emerald-300 text-[11px] mb-1">Instalaci√≥n Autom√°tica</h4><p class="text-[8px] text-slate-400 leading-relaxed">El instalador hace <strong class="text-white">TODO autom√°ticamente</strong>: compila el .exe, crea accesos directos en el Escritorio y Men√∫ Inicio, y abre la app al terminar.</p></div></div></div>

${divider('Instalar en 3 pasos')}
<div class="card p-4 mb-3 hover-glow"><div class="space-y-3">
<div class="flex items-start gap-3"><div class="w-8 h-8 bg-indigo-500/15 rounded-lg flex items-center justify-center text-sm font-black text-indigo-400 flex-shrink-0">1</div><div><p class="text-[10px] text-white font-bold mb-0.5">Descarga los 2 archivos</p><p class="text-[8px] text-slate-500">Ponlos en la <strong class="text-slate-300">misma carpeta</strong> (cualquiera sirve)</p><div class="flex gap-1.5 mt-1.5"><button onclick="dlPS1()" class="btn btn-v px-3 py-1.5">‚¨á Crear_EXE.ps1</button><button onclick="dlIndex()" class="btn btn-p px-3 py-1.5">‚¨á index.html</button></div></div></div>
<div class="flex items-start gap-3"><div class="w-8 h-8 bg-indigo-500/15 rounded-lg flex items-center justify-center text-sm font-black text-indigo-400 flex-shrink-0">2</div><div><p class="text-[10px] text-white font-bold mb-0.5">Clic derecho en Crear_EXE.ps1 ‚Üí Ejecutar con PowerShell</p><p class="text-[8px] text-slate-500">El instalador se encarga de todo autom√°ticamente</p></div></div>
<div class="flex items-start gap-3"><div class="w-8 h-8 bg-emerald-500/15 rounded-lg flex items-center justify-center text-sm font-black text-emerald-400 flex-shrink-0">‚úì</div><div><p class="text-[10px] text-white font-bold mb-0.5">¬°Listo! PCTuner se abre solo</p><p class="text-[8px] text-slate-500">Acceso directo en tu Escritorio y Men√∫ Inicio</p></div></div>
</div></div>

${divider('Qu√© hace el instalador')}
<div class="grid grid-cols-2 md:grid-cols-5 gap-1.5 mb-3">${[['üìÇ','Crea carpeta','AppData/PCTuner'],['‚öôÔ∏è','Compila .exe','C# nativo'],['üñ•Ô∏è','Acceso directo','Escritorio'],['üìå','Men√∫ Inicio','Windows'],['üöÄ','Auto-abre','La app']].map(([ic,t,d])=>`<div class="card p-2 text-center"><p class="text-sm">${ic}</p><p class="text-[8px] font-bold text-white mt-0.5">${t}</p><p class="text-[6px] text-slate-600">${d}</p></div>`).join('')}</div>

<div class="card p-2.5 mb-3 border-l-2 border-l-amber-500/30"><div class="flex items-start gap-2"><span class="text-sm">üí°</span><div><p class="text-[8px] text-amber-200/70">Si PowerShell bloquea la ejecuci√≥n, abre PowerShell como Admin y ejecuta:</p><p class="mono text-[8px] text-amber-400 mt-0.5">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</p></div></div></div>

<div class="card p-4 text-center hover-glow"><button onclick="dlPS1();setTimeout(()=>dlIndex(),400)" class="btn btn-s px-6 py-2.5 text-[11px]">‚¨á Descargar Todo e Instalar</button><p class="text-[7px] text-slate-700 mt-2">Descarga ambos archivos ‚Üí Ejecuta Crear_EXE.ps1 ‚Üí Listo</p><p class="text-[6px] text-slate-800 mt-0.5">Sin instalar nada extra ¬∑ Sin internet despu√©s ¬∑ 100% portable</p></div>`;}
function dlIndex(){const b=new Blob([document.documentElement.outerHTML],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='index.html';document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);notify('‚¨á index.html descargado','#10b981');}
function dlPS1(){dl('Crear_EXE.ps1',getPS1Content());notify('‚¨á Crear_EXE.ps1 descargado','#10b981');}
function _dlPS1_REMOVED(){return;dl('Crear_EXE.ps1',`# ============================================
# PCTuner Pro v6 ‚Äî Instalador Automatico
# Solo ejecuta este archivo con PowerShell
# ============================================

Write-Host ""
Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor Cyan
Write-Host "  ‚ïë     PCTuner Pro v6 ‚Äî Instalador      ‚ïë" -ForegroundColor Cyan
Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor Cyan
Write-Host ""

# Verificar que index.html existe junto al script
$scriptDir = $PSScriptRoot
$htmlFile = Join-Path $scriptDir "index.html"

if (-not (Test-Path $htmlFile)) {
    Write-Host "  [ERROR] index.html no encontrado!" -ForegroundColor Red
    Write-Host "  Coloca index.html junto a este archivo." -ForegroundColor Yellow
    Read-Host "  Presiona Enter para cerrar"
    exit
}

Write-Host "  [1/5] Creando carpeta de instalacion..." -ForegroundColor Yellow
$installDir = Join-Path $env:LOCALAPPDATA "PCTuner"
if (-not (Test-Path $installDir)) { New-Item -Path $installDir -ItemType Directory -Force | Out-Null }

Write-Host "  [2/5] Copiando archivos..." -ForegroundColor Yellow
Copy-Item $htmlFile (Join-Path $installDir "index.html") -Force

Write-Host "  [3/5] Compilando PCTuner.exe..." -ForegroundColor Yellow

$exeSrc = @"
using System;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;

class PCTuner {
    [DllImport("kernel32.dll")] static extern IntPtr GetConsoleWindow();
    [DllImport("user32.dll")] static extern bool ShowWindow(IntPtr h, int s);

    static void Main() {
        ShowWindow(GetConsoleWindow(), 0);
        string dir = AppDomain.CurrentDomain.BaseDirectory;
        string html = Path.Combine(dir, "index.html");
        if (!File.Exists(html)) { return; }
        string url = "file:///" + html.Replace("\\\\", "/");
        string[] browsers = { "chrome", "msedge" };
        foreach (var b in browsers) {
            try {
                var psi = new ProcessStartInfo(b);
                psi.Arguments = "--app=\\"" + url + "\\" --window-size=1300,850 --disable-extensions --disable-sync --no-first-run --disable-default-apps";
                psi.UseShellExecute = false;
                psi.CreateNoWindow = true;
                Process.Start(psi);
                return;
            } catch {}
        }
        Process.Start(html);
    }
}
"@

try {
    Add-Type -TypeDefinition $exeSrc -OutputAssembly (Join-Path $installDir "PCTuner.exe") -OutputType ConsoleApplication -ErrorAction Stop
    Write-Host "  [3/5] PCTuner.exe compilado OK!" -ForegroundColor Green
} catch {
    Write-Host "  [3/5] Error compilando. Usando launcher alternativo..." -ForegroundColor Yellow
    $batContent = "@echo off\`nstart /b \\"\\" chrome --app=\\"file:///$($installDir.Replace('\\\\','/'))//index.html\\" --window-size=1300,850 2>nul || start /b \\"\\" msedge --app=\\"file:///$($installDir.Replace('\\\\','/'))//index.html\\" --window-size=1300,850"
    Set-Content (Join-Path $installDir "PCTuner.bat") $batContent
}

Write-Host "  [4/5] Creando acceso directo en Escritorio..." -ForegroundColor Yellow
$desktop = [Environment]::GetFolderPath("Desktop")
$exePath = Join-Path $installDir "PCTuner.exe"
if (-not (Test-Path $exePath)) { $exePath = Join-Path $installDir "PCTuner.bat" }

$shell = New-Object -ComObject WScript.Shell
$shortcut = $shell.CreateShortcut((Join-Path $desktop "PCTuner Pro.lnk"))
$shortcut.TargetPath = $exePath
$shortcut.WorkingDirectory = $installDir
$shortcut.Description = "PCTuner Pro v6 ‚Äî Optimizador de PC"
$shortcut.Save()

# Tambien crear en Menu Inicio
Write-Host "  [5/5] Creando acceso en Menu Inicio..." -ForegroundColor Yellow
$startMenu = Join-Path $env:APPDATA "Microsoft\\Windows\\Start Menu\\Programs"
$shortcut2 = $shell.CreateShortcut((Join-Path $startMenu "PCTuner Pro.lnk"))
$shortcut2.TargetPath = $exePath
$shortcut2.WorkingDirectory = $installDir
$shortcut2.Description = "PCTuner Pro v6"
$shortcut2.Save()

Write-Host ""
Write-Host "  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó" -ForegroundColor Green
Write-Host "  ‚ïë  ‚úÖ INSTALACION COMPLETADA!           ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïë                                      ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïë  üìÇ Ubicacion:                        ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïë     $($installDir.PadRight(33))‚ïë" -ForegroundColor Cyan
Write-Host "  ‚ïë                                      ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïë  üñ•Ô∏è Acceso directo en Escritorio      ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïë  üìå Acceso en Menu Inicio             ‚ïë" -ForegroundColor Green
Write-Host "  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù" -ForegroundColor Green
Write-Host ""

# Auto-ejecutar la app
Write-Host "  Abriendo PCTuner Pro..." -ForegroundColor Cyan
Start-Process $exePath -WorkingDirectory $installDir

Write-Host ""
Write-Host "  Ya puedes cerrar esta ventana." -ForegroundColor DarkGray
Start-Sleep -Seconds 3
`);notify('‚¨á Crear_EXE.ps1 descargado','#10b981');}

// ==================== ABOUT / DONATE / CREDITS ====================
function pAbout(){const h=S.hw;return`${hdr('‚ÑπÔ∏è','Acerca de','Hardware detectado')}<div class="card p-4 text-center mb-3 fade-up"><div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-violet-600 rounded-xl flex items-center justify-center text-lg font-black text-white mx-auto mb-2">PC</div><h2 class="text-base font-black text-white">PCTuner Pro v6.0</h2><p class="text-[10px] text-slate-400">por <span class="credit-gradient font-bold cursor-pointer" onclick="go('credits')">mueblesito</span></p></div>${divider('Sistema')}<div class="grid md:grid-cols-2 gap-2 mb-3"><div class="card p-3">${[['OS',h.os+' '+(h.osVer||'')],['Arch',h.arch||'‚Äî'],['Marca',h.brand||'‚Äî'],['Cores',h.cores+' threads'],['RAM',h.ram?h.ram+' GB':'‚Äî'],['Clase CPU',h.cpuClass||'‚Äî']].map(([k,v])=>`<div class="flex justify-between mb-0.5"><span class="text-[8px] text-slate-500">${k}</span><span class="text-[8px] text-white mono">${v}</span></div>`).join('')}</div><div class="card p-3">${[['GPU',(h.gpuClean||h.gpu||'‚Äî').substring(0,30)],['GPU Marca',h.gpuBrand||'‚Äî'],['Tier',h.gpuTier||'‚Äî'],['Browser',h.browser||'‚Äî'],['Pantalla',h.screenW+'√ó'+h.screenH],['DPR',h.dpr+'x']].map(([k,v])=>`<div class="flex justify-between mb-0.5"><span class="text-[8px] text-slate-500">${k}</span><span class="text-[8px] text-white mono">${v}</span></div>`).join('')}</div></div>${h.battery?`<div class="card p-3 mb-3"><div class="flex items-center gap-2"><span class="text-lg">${h.charging?'üîå':'üîã'}</span><div><p class="text-[9px] font-bold ${h.batteryLevel>20?'text-emerald-400':'text-red-400'}">${h.batteryLevel}%${h.charging?' Cargando':''}</p><div class="w-32 h-1.5 bg-slate-800/50 rounded-full overflow-hidden mt-0.5"><div class="h-full rounded-full ${h.batteryLevel>50?'bg-emerald-500':'bg-amber-500'}" style="width:${h.batteryLevel}%"></div></div></div></div></div>`:''}<div class="card p-2.5"><p class="text-[7px] text-slate-600 mono break-all">${h.userAgent||''}</p></div>`;}

function pDonate(){return`<div class="max-w-md mx-auto">
<div class="card p-5 text-center mb-4 fade-up"><div class="heart-beat text-3xl mb-2">üíñ</div><h2 class="text-base font-black credit-gradient mb-1">Apoya PCTuner</h2><p class="text-[9px] text-slate-400">100% gratis, sin anuncios, open source.</p></div>
${divider('PayPal')}
<div class="card p-4 text-center mb-4 hover-glow fade-up">
<p class="text-2xl mb-2">üí≥</p>
<p class="text-[7px] text-slate-600 mb-1">CORREO PAYPAL</p>
<div class="stat p-2 mb-3 cursor-pointer inline-block" onclick="navigator.clipboard.writeText('memogutierrez087@gmail.com').then(()=>notify('üìã Copiado','#10b981'))"><p class="text-[10px] text-amber-400 font-bold mono">memogutierrez087@gmail.com</p><p class="text-[6px] text-slate-600 mt-0.5">clic para copiar</p></div>
<a href="https://paypal.me/memogutierrez087" target="_blank" class="btn w-full py-2 text-[11px] font-bold mb-1" style="background:linear-gradient(135deg,#003087,#0070e0)">Donar con PayPal</a>
<p class="text-[7px] text-slate-700 mt-1">Cualquier monto es bienvenido üíñ</p>
</div>
<div class="card p-3 text-center fade-up"><p class="text-[9px] text-slate-500">Gracias por apoyar el proyecto</p><p class="text-[7px] text-slate-700 mt-0.5">‚Äî <span class="credit-gradient font-bold">mueblesito</span></p></div>
</div>`;}

function pCredits(){const stars=Array.from({length:6},()=>`<div class="star" style="top:${Math.random()*100}%;left:${Math.random()*100}%;animation-delay:${Math.random()*3}s"></div>`).join('');return`<div class="relative">${stars}<div class="orb orb-1"></div><div class="orb orb-2"></div>

<div class="card p-5 text-center mb-4 hover-glow fade-up" style="animation:scaleIn 0.3s ease both;background:linear-gradient(135deg,rgba(12,15,24,0.95),rgba(16,12,30,0.9))"><div class="credit-avatar w-16 h-16 bg-gradient-to-br from-indigo-500 via-violet-500 to-pink-500 rounded-xl flex items-center justify-center text-2xl font-black text-white mx-auto mb-3 shadow-lg shadow-indigo-500/10">ü™ë</div><h2 class="text-lg font-black credit-gradient mb-0.5">mueblesito</h2><p class="text-slate-400 text-[10px]">Creador & Desarrollador</p><div class="flex items-center justify-center gap-1 mt-1.5"><span class="w-1.5 h-1.5 bg-emerald-400 rounded-full pulse-a"></span><span class="text-[8px] text-emerald-400 font-semibold">Activo</span></div><p class="text-[8px] text-slate-500 mt-2.5 max-w-xs mx-auto leading-relaxed">Cre√© PCTuner Pro para hacer la optimizaci√≥n de Windows accesible para todos. Seguro, transparente y gratuito.</p><button onclick="go('donate')" class="btn mt-3 px-4 py-1.5 text-[10px]" style="background:linear-gradient(135deg,#ec4899,#8b5cf6)"><span class="heart-beat inline-block">üíñ</span> Apoyar</button></div>

<div class="grid grid-cols-2 md:grid-cols-4 gap-1.5 mb-4 stagger">${[['‚ú®','v6.0','Versi√≥n','indigo'],['‚ö°','22','Secciones','violet'],['üîß','130+','Opciones','pink'],['üõ°Ô∏è','100%','Defender Safe','emerald']].map(([ic,val,label,col])=>`<div class="card p-2.5 text-center hover-glow"><p class="text-base">${ic}</p><p class="text-sm font-black text-${col}-400">${val}</p><p class="text-[7px] text-slate-600">${label}</p></div>`).join('')}</div>

${divider('El Viaje')}
<div class="card p-4 mb-4 hover-glow fade-up"><div class="relative ml-2">
<div class="absolute left-[3px] top-0 bottom-4 w-px bg-gradient-to-b from-indigo-500/30 via-violet-500/20 to-transparent"></div>
<div class="space-y-3">${[
{v:'v1.0',t:'El Inicio',d:'Un simple script .bat con 10 comandos b√°sicos de limpieza. Todo empez√≥ con la necesidad de optimizar mi propia PC.',c:'#6366f1',ic:'üå±'},
{v:'v2.0',t:'La Interfaz',d:'Migraci√≥n a interfaz visual. Seleccionar optimizaciones en vez de editar c√≥digo manualmente.',c:'#8b5cf6',ic:'üåê'},
{v:'v3.0',t:'Dashboard',d:'Primer dashboard con toggles, keybinds personalizables y presets. Ya no era solo un script.',c:'#a78bfa',ic:'üìä'},
{v:'v4.0',t:'Hardware Detect',d:'Detecci√≥n autom√°tica de hardware. La app se adapta a tu PC autom√°ticamente.',c:'#c084fc',ic:'üîç'},
{v:'v5.0',t:'App Universal',d:'Soporte multi-marca, monitor en tiempo real, ventiladores, terminal integrada y perfiles.',c:'#e879f9',ic:'üöÄ'},
{v:'v6.0',t:'Edici√≥n Pro',d:'Redise√±o total. +130 opciones, curvas de ventilador por perfil, creador de .exe, exportaci√≥n multi-formato. La versi√≥n definitiva.',c:'#ec4899',ic:'üëë'}
].map((e,i)=>`<div class="flex items-start gap-3 relative"><div class="w-2 h-2 rounded-full flex-shrink-0 mt-1.5 relative z-10" style="background:${e.c};box-shadow:0 0 6px ${e.c}40"></div><div class="flex-1 pb-1"><div class="flex items-center gap-2 mb-0.5"><span class="text-sm">${e.ic}</span><span class="mono text-[8px] font-bold px-1.5 py-0.5 rounded-full" style="color:${e.c};background:${e.c}10;border:1px solid ${e.c}20">${e.v}</span><span class="font-bold text-white text-[10px]">${e.t}</span></div><p class="text-[8px] text-slate-500 leading-relaxed">${e.d}</p></div></div>`).join('')}
</div></div></div>

<div class="grid md:grid-cols-2 gap-2 mb-4 stagger">
<div class="card p-3 hover-glow"><h4 class="font-bold text-white text-[10px] mb-2 flex items-center gap-1.5">üí° <span>Principios</span></h4><div class="space-y-1.5">${[['üéØ','Simple','Cualquiera puede usarlo'],['üõ°Ô∏è','Seguro','Defender nunca se toca'],['üîç','Transparente','C√≥digo visible y abierto'],['‚ö°','Eficiente','Ligero y r√°pido'],['üåç','Universal','Funciona en cualquier PC']].map(([ic,t,d])=>`<div class="flex items-center gap-2"><span class="text-xs">${ic}</span><div><span class="text-[9px] text-white font-semibold">${t}</span><span class="text-[7px] text-slate-600 ml-1">‚Äî ${d}</span></div></div>`).join('')}</div></div>
<div class="card p-3 hover-glow"><h4 class="font-bold text-white text-[10px] mb-2 flex items-center gap-1.5">üõ†Ô∏è <span>Tecnolog√≠as</span></h4><div class="flex flex-wrap gap-1 mb-2">${['UI Engine','Hardware Bridge','Script Engine','Canvas API','Batch','PowerShell','AutoHotkey','LocalStorage','WebGL','Crypto API'].map(n=>`<span class="tech-badge text-indigo-400" style="border-color:rgba(99,102,241,0.15)">${n}</span>`).join('')}</div><p class="text-[7px] text-slate-600 mt-1">Todo en un solo archivo. Sin dependencias. Sin servidor.</p></div>
</div>

<div class="card p-4 text-center hover-glow fade-up" style="background:linear-gradient(135deg,rgba(12,15,24,0.95),rgba(16,12,30,0.9))"><p class="text-[10px] text-slate-400 mb-1">Hecho con ‚ù§Ô∏è por</p><h3 class="text-base font-black credit-gradient mb-2">mueblesito</h3><div class="flex justify-center gap-2"><button onclick="go('donate')" class="btn px-3 py-1.5 text-[9px]" style="background:linear-gradient(135deg,#ec4899,#8b5cf6)"><span class="heart-beat inline-block text-xs">üíñ</span> Apoyar</button><button onclick="go('about')" class="btn btn-g px-3 py-1.5 text-[9px]">‚ÑπÔ∏è Info</button></div><p class="text-[7px] text-slate-800 mt-2">PCTuner Pro v6.0 ¬∑ ¬© ${new Date().getFullYear()}</p></div>
</div>`;}

// ==================== PRESETS ====================
function applyPreset(p){Object.keys(S.toggles).forEach(k=>S.toggles[k]=false);const pr={balanced:['p_sysmain','p_indexing','p_visual','p_transparency','p_startup_delay','p_menu_delay','p_tips','p_cpu_priority','c_temp','c_recycle','c_dns','n_flush','n_qos','pw_high','pr_telemetry','pr_cortana','pr_ad_id','t_search','t_widgets','t_copilot','e_ext','e_thispc','v_dark','v_dark_apps','sv_diagtrack','m_restore','g_mode','fan_smart'],max:['p_sysmain','p_prefetch','p_indexing','p_visual','p_transparency','p_startup_delay','p_menu_delay','p_tips','p_cpu_priority','p_ntfs_last','p_core_parking','c_temp','c_recycle','c_update','c_dns','c_bloatware','n_flush','n_nagle','n_qos','pw_high','pw_hibernate','pw_usb','pw_cpu_max','pr_telemetry','pr_cortana','pr_ad_id','pr_feedback','pr_suggestions','t_search','t_widgets','t_copilot','v_dark','v_dark_apps','v_no_anim','v_no_trans','sv_diagtrack','sv_dmwap','sv_sysmain','sv_wsearch','sv_xbox','g_mode','g_dvr','g_fullscreen','g_mouse','g_xbox','e_ext','e_classic','e_compact','m_sfc','m_dism','m_defrag','m_restore','b_onedrive','b_teams','b_edge','b_cortana','wu_no_restart','sec_autoplay','fan_smart'],privacy:['pr_telemetry','pr_cortana','pr_activity','pr_ad_id','pr_location','pr_diag','pr_feedback','pr_suggestions','pr_lockscreen','pr_timeline','pr_clipboard','pr_input','sv_diagtrack','sv_dmwap','t_widgets','t_copilot','wu_no_peer','sec_autoplay','sec_wpad','m_restore','fan_smart'],silent:['fan_smart','p_visual','p_transparency','v_no_anim','m_restore'],battery:['p_sysmain','p_visual','p_transparency','p_indexing','v_no_anim','v_no_trans','sv_wsearch','sv_xbox','fan_smart','m_restore','b_onedrive','b_teams','t_widgets']};
const fanMap={balanced:'balanced',max:'performance',privacy:'balanced',silent:'silent',battery:'silent'};
if(pr[p])pr[p].forEach(k=>{S.toggles[k]=true;track(k,true);});
S.fan.profile=fanMap[p]||'balanced';track('fan_profile',S.fan.profile);
render(S.page);notify('‚úÖ Preset aplicado ¬∑ Ventilador: '+(({balanced:'‚öñÔ∏è Equilibrado',performance:'üî• Rendimiento',silent:'ü§´ Silencioso',custom:'üõ†Ô∏è Custom'})[S.fan.profile]),'#10b981');}

// ==================== NOTIFICACIONES ====================
function notify(msg,bg='#6366f1'){const s=document.getElementById('nStack'),d=document.createElement('div');d.className='notif fade-up';d.style.background=bg;d.textContent=msg;s.appendChild(d);setTimeout(()=>{d.style.animation='fadeOut 0.15s ease forwards';setTimeout(()=>d.remove(),150);},2200);}

// ==================== EJECUTAR ====================
function openExec(){document.getElementById('execModal').classList.remove('hidden');renderExec();}
function quickExec(){const a=Object.values(S.toggles).filter(v=>v).length;if(!a){notify('‚ö†Ô∏è Activa opciones primero','#f59e0b');go('performance');return;}openExec();}
function closeExec(){document.getElementById('execModal').classList.add('hidden');}
function renderExec(){const a=Object.entries(S.toggles).filter(([,v])=>v),b=document.getElementById('execBody');if(!a.length){b.innerHTML=`<div class="text-center py-4"><p class="text-xl mb-1">‚ö°</p><p class="text-[10px] text-slate-400">Sin optimizaciones activas. Activa opciones en las secciones.</p><button onclick="closeExec();go('performance')" class="btn btn-p px-3 py-1.5 mt-2 text-[9px]">‚ö° Ir a Rendimiento</button></div>`;return;}
b.innerHTML=`<p class="font-bold text-white text-sm mb-1">üöÄ ${a.length} optimizaciones listas</p><p class="text-[8px] text-slate-500 mb-2">${S.hw.brand} ¬∑ ${S.hw.os} ${S.hw.osVer||''}</p><div class="card p-2 mb-2 border-l-2 border-l-emerald-500/30"><p class="text-[8px] text-emerald-200/70">üõ°Ô∏è Defender NO se modifica ¬∑ Punto de restauraci√≥n autom√°tico</p></div><div class="space-y-0.5 mb-3 max-h-[100px] overflow-y-auto bg-slate-900/30 rounded-lg p-2">${a.map(([k])=>`<div class="flex items-center gap-1 text-[8px]"><span class="text-emerald-400">‚úì</span><span class="text-slate-400 mono">${k}</span></div>`).join('')}</div><button onclick="execNow()" class="btn btn-s px-5 py-2.5 w-full text-[12px] font-bold mb-1.5">‚ñ∂ EJECUTAR AHORA</button><p class="text-[7px] text-slate-600 text-center mb-0.5">Se descarga un archivo que aplica todos los cambios</p><p class="text-[7px] text-amber-400/60 text-center mb-3">Solo haz doble clic en el archivo descargado</p>${divider('Otros formatos')}<div class="grid grid-cols-4 gap-1">${[['bat','üìÑ','.BAT'],['ps1','üî∑','.PS1'],['reg','üóùÔ∏è','.REG'],['ahk','‚å®Ô∏è','.AHK']].map(([f,ic,n])=>`<button onclick="execDl('${f}')" class="btn btn-g py-1.5 flex flex-col items-center gap-0.5 text-[8px]"><span class="text-sm">${ic}</span>${n}</button>`).join('')}</div>`;}
function execNow(){const a=Object.values(S.toggles).filter(v=>v).length;if(!a){notify('‚ö†Ô∏è Sin opciones activas','#f59e0b');return;}const btn=document.querySelector('#execBody .btn-s');if(btn){btn.textContent='‚è≥ Generando...';btn.disabled=true;}setTimeout(()=>{dl('PCTuner_'+S.hw.brand+'_Ejecutar.bat',genBAT());notify('‚úÖ Descargado ‚Äî Haz doble clic para ejecutar','#10b981');setTimeout(closeExec,500);},400);}
function execDl(f){const g={bat:genBAT,ps1:genPS1,reg:genREG,ahk:genAHK},x={bat:'.bat',ps1:'.ps1',reg:'.reg',ahk:'.ahk'};dl('PCTuner_'+S.hw.brand+'_'+f.toUpperCase()+x[f],g[f]());notify('‚¨á Descargado','#10b981');closeExec();}

// ==================== EXPORTAR ====================
function openExport(){document.getElementById('exportModal').classList.remove('hidden');}
function closeExport(){document.getElementById('exportModal').classList.add('hidden');}
function genScript(){const f=document.getElementById('expFmt').value,g={bat:genBAT,ps1:genPS1,reg:genREG,ahk:genAHK},x={bat:'.bat',ps1:'.ps1',reg:'.reg',ahk:'.ahk'};_code=g[f]();_fn='PCTuner_'+S.hw.brand+x[f];document.getElementById('expTitle').textContent=_fn;document.getElementById('expBody').innerHTML=`<pre class="p-3 text-[8px] text-emerald-400 mono leading-relaxed">${_code.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}</pre>`;document.getElementById('expFoot').classList.remove('hidden');document.getElementById('expInfo').textContent=_code.split('\n').length+' l√≠neas';}
function copyCode(){navigator.clipboard.writeText(_code).then(()=>{const b=document.getElementById('copyBtn');b.textContent='‚úÖ';setTimeout(()=>b.textContent='üìã Copiar',1000);});}
function dlCode(){dl(_fn,_code);}
function dl(n,c){const b=new Blob([c],{type:'text/plain'}),u=URL.createObjectURL(b),a=document.createElement('a');a.href=u;a.download=n;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);}

// ==================== GENERADORES DE SCRIPTS ====================
function genBAT(){const h=S.hw;let s=`@echo off
chcp 65001 >nul
:: ============================================
:: PCTuner Pro v6 ‚Äî ${h.brand}
:: Auto-elevaci√≥n a Administrador
:: Defender: NUNCA se modifica
:: ============================================

net session >nul 2>&1
if %errorlevel% neq 0 (
    echo Solicitando permisos de administrador...
    powershell -Command "Start-Process -FilePath '%~f0' -Verb RunAs"
    exit /b
)

title PCTUNER PRO v6 ‚Äî ${h.brand}
color 0A
echo.
echo  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
echo  ‚ïë     PCTUNER PRO v6 ‚Äî ${h.brand.padEnd(14)}     ‚ïë
echo  ‚ïë     Defender: INTACTO               ‚ïë
echo  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
echo.

`;
if(T('m_restore'))s+=`echo  [*] Creando punto de restauracion...\nPowerShell -Command "Checkpoint-Computer -Description 'PCTuner_v6' -RestorePointType 'MODIFY_SETTINGS'" 2>nul\n`;
if(T('p_sysmain'))s+=`echo  [*] Desactivando SysMain...\nsc config "SysMain" start= disabled >nul 2>&1 & sc stop "SysMain" >nul 2>&1\n`;
if(T('p_prefetch'))s+=`echo  [*] Desactivando Prefetch...\nreg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters" /v EnablePrefetcher /t REG_DWORD /d 0 /f >nul\n`;
if(T('p_indexing'))s+=`echo  [*] Desactivando Windows Search...\nsc config "WSearch" start= disabled >nul 2>&1 & sc stop "WSearch" >nul 2>&1\n`;
if(T('p_visual'))s+=`echo  [*] Optimizando efectos visuales...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VisualEffects" /v VisualFXSetting /t REG_DWORD /d 2 /f >nul\n`;
if(T('p_transparency'))s+=`echo  [*] Desactivando transparencias...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v EnableTransparency /t REG_DWORD /d 0 /f >nul\n`;
if(T('p_startup_delay'))s+=`echo  [*] Eliminando delay de inicio...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Serialize" /v StartupDelayInMSec /t REG_DWORD /d 0 /f >nul\n`;
if(T('p_menu_delay'))s+=`echo  [*] Acelerando menus...\nreg add "HKCU\\Control Panel\\Desktop" /v MenuShowDelay /t REG_SZ /d "20" /f >nul\n`;
if(T('p_cpu_priority'))s+=`echo  [*] Priorizando ventana activa...\nreg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\PriorityControl" /v Win32PrioritySeparation /t REG_DWORD /d 38 /f >nul\n`;
if(T('p_ntfs_last'))s+=`echo  [*] Optimizando NTFS...\nfsutil behavior set disablelastaccess 1 >nul\n`;
if(T('p_core_parking'))s+=`echo  [*] Desactivando Core Parking...\npowercfg -setacvalueindex SCHEME_CURRENT SUB_PROCESSOR CPMINCORES 100 >nul 2>&1\n`;
if(T('c_temp'))s+=`echo  [*] Limpiando temporales...\ndel /q /f /s "%TEMP%\\*" 2>nul\ndel /q /f /s "C:\\Windows\\Temp\\*" 2>nul\n`;
if(T('c_recycle'))s+=`echo  [*] Vaciando papelera...\nrd /s /q C:\\$Recycle.Bin 2>nul\n`;
if(T('c_dns'))s+=`echo  [*] Limpiando cache DNS...\nipconfig /flushdns >nul\n`;
if(T('c_bloatware'))s+=`echo  [*] Removiendo bloatware...\nPowerShell -Command "Get-AppxPackage *3dbuilder*,*solitaire*,*bingnews*,*bingweather*,*zunevideo*,*xboxapp* | Remove-AppxPackage -EA SilentlyContinue" 2>nul\n`;
if(T('c_prefetch'))s+=`echo  [*] Limpiando Prefetch...\ndel /q /f "C:\\Windows\\Prefetch\\*" 2>nul\n`;
if(T('c_font_cache'))s+=`echo  [*] Limpiando cache fuentes...\nnet stop FontCache >nul 2>&1 & del /q /f "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache\\*" 2>nul & net start FontCache >nul 2>&1\n`;
if(T('c_installer'))s+=`echo  [*] Limpiando Windows Installer...\nPowerShell -Command "Dism.exe /Online /Cleanup-Image /StartComponentCleanup" 2>nul\n`;
if(T('c_downloads'))s+=`echo  [*] Limpiando descargas antiguas...\nforfiles /p "%USERPROFILE%\\Downloads" /s /m *.* /d -30 /c "cmd /c del @path" 2>nul\n`;
if(T('c_browser'))s+=`echo  [*] Limpiando cache navegadores...\ndel /q /f /s "%LOCALAPPDATA%\\Google\\Chrome\\User Data\\Default\\Cache\\*" 2>nul\ndel /q /f /s "%LOCALAPPDATA%\\Microsoft\\Edge\\User Data\\Default\\Cache\\*" 2>nul\n`;
if(T('c_cortana'))s+=`echo  [*] Limpiando Cortana...\ndel /q /f /s "%LOCALAPPDATA%\\Packages\\Microsoft.Windows.Cortana_*\\LocalState\\*" 2>nul\n`;
if(T('c_thumb'))s+=`echo  [*] Limpiando miniaturas...\ndel /q /f /s "%LOCALAPPDATA%\\Microsoft\\Windows\\Explorer\\thumbcache_*" 2>nul\n`;
if(T('c_update'))s+=`echo  [*] Limpiando cache Updates...\nnet stop wuauserv >nul 2>&1 & del /q /f /s "C:\\Windows\\SoftwareDistribution\\Download\\*" 2>nul & net start wuauserv >nul 2>&1\n`;
if(T('c_delivery'))s+=`echo  [*] Limpiando Delivery Optimization...\ndel /q /f /s "C:\\Windows\\SoftwareDistribution\\DeliveryOptimization\\*" 2>nul\n`;
if(T('c_error'))s+=`echo  [*] Limpiando reportes error...\ndel /q /f /s "C:\\ProgramData\\Microsoft\\Windows\\WER\\*" 2>nul\n`;
if(T('c_logs'))s+=`echo  [*] Limpiando logs...\nfor /F "tokens=*" %%G in ('wevtutil.exe el') DO (call wevtutil.exe cl "%%G" 2>nul)\n`;
if(T('n_flush'))s+=`echo  [*] Flush DNS...\nipconfig /flushdns >nul & ipconfig /registerdns >nul\n`;
if(T('n_winsock'))s+=`echo  [*] Reset Winsock...\nnetsh winsock reset >nul\n`;
if(T('n_tcpip'))s+=`echo  [*] Reset TCP/IP...\nnetsh int ip reset >nul\n`;
if(T('n_nagle'))s+=`echo  [*] Desactivando Nagle...\nreg add "HKLM\\SOFTWARE\\Microsoft\\MSMQ\\Parameters" /v TCPNoDelay /t REG_DWORD /d 1 /f >nul\n`;
if(T('n_autotuning'))s+=`echo  [*] Desactivando Auto-Tuning...\nnetsh int tcp set global autotuninglevel=disabled >nul\n`;
const dm={google:['8.8.8.8','8.8.4.4'],cloudflare:['1.1.1.1','1.0.0.1'],quad9:['9.9.9.9','149.112.112.112']},dns=SE('n_dns')||'cloudflare',adp=SE('n_adapter')==='ethernet'?'Ethernet':'Wi-Fi';
if(dns!=='default'&&dm[dns])s+=`echo  [*] Configurando DNS ${dns}...\nnetsh interface ip set dns "${adp}" static ${dm[dns][0]} primary >nul\nnetsh interface ip add dns "${adp}" ${dm[dns][1]} index=2 >nul\n`;
if(T('pw_high'))s+=`echo  [*] Plan Alto Rendimiento...\npowercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c >nul 2>&1\n`;
if(T('pw_hibernate'))s+=`echo  [*] Desactivando hibernacion...\npowercfg /hibernate off >nul\n`;
if(T('pr_telemetry'))s+=`echo  [*] Bloqueando telemetria...\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f >nul\nsc config "DiagTrack" start= disabled >nul 2>&1\n`;
if(T('pr_cortana'))s+=`echo  [*] Desactivando Cortana...\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f >nul\n`;
if(T('pr_ad_id'))s+=`echo  [*] Desactivando ID publicidad...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f >nul\n`;
if(T('t_search'))s+=`echo  [*] Ocultando busqueda...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search" /v SearchboxTaskbarMode /t REG_DWORD /d 0 /f >nul\n`;
if(T('t_widgets'))s+=`echo  [*] Desactivando widgets...\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Dsh" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f >nul\n`;
if(T('t_copilot'))s+=`echo  [*] Desactivando Copilot...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v ShowCopilotButton /t REG_DWORD /d 0 /f >nul\n`;
if(SE('t_align')==='left')s+=`echo  [*] Taskbar izquierda...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarAl /t REG_DWORD /d 0 /f >nul\n`;
if(T('v_dark'))s+=`echo  [*] Modo oscuro...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v SystemUsesLightTheme /t REG_DWORD /d 0 /f >nul\n`;
if(T('v_dark_apps'))s+=`echo  [*] Apps oscuras...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v AppsUseLightTheme /t REG_DWORD /d 0 /f >nul\n`;
if(T('e_ext'))s+=`echo  [*] Mostrando extensiones...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v HideFileExt /t REG_DWORD /d 0 /f >nul\n`;
if(T('e_classic'))s+=`echo  [*] Menu clasico Win11...\nreg add "HKCU\\Software\\Classes\\CLSID\\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\\InprocServer32" /f /ve >nul 2>&1\n`;
if(T('g_dvr'))s+=`echo  [*] Desactivando Game DVR...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\GameDVR" /v AppCaptureEnabled /t REG_DWORD /d 0 /f >nul\n`;
if(T('g_xbox'))s+=`echo  [*] Desactivando Xbox Bar...\nreg add "HKCU\\Software\\Microsoft\\GameBar" /v UseNexusForGameBarEnabled /t REG_DWORD /d 0 /f >nul\n`;
if(T('sv_diagtrack'))s+=`echo  [*] Desactivando DiagTrack...\nsc config "DiagTrack" start= disabled >nul 2>&1\n`;
if(T('sv_dmwap'))s+=`echo  [*] Desactivando dmwappush...\nsc config "dmwappushservice" start= disabled >nul 2>&1\n`;
if(T('sv_sysmain'))s+=`echo  [*] Desactivando SysMain...\nsc config "SysMain" start= disabled >nul 2>&1\n`;
if(T('sv_wsearch'))s+=`echo  [*] Desactivando Windows Search...\nsc config "WSearch" start= disabled >nul 2>&1\n`;
if(T('sv_xbox'))s+=`echo  [*] Desactivando Xbox...\nsc config "XblAuthManager" start= disabled >nul 2>&1\n`;
if(T('sv_fax'))s+=`echo  [*] Desactivando Fax...\nsc config "Fax" start= disabled >nul 2>&1\n`;
if(T('sv_maps'))s+=`echo  [*] Desactivando MapsBroker...\nsc config "MapsBroker" start= disabled >nul 2>&1\n`;
if(T('sec_autoplay'))s+=`echo  [*] Desactivando AutoPlay...\nreg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\AutoplayHandlers" /v DisableAutoplay /t REG_DWORD /d 1 /f >nul\n`;
if(T('sec_smb1'))s+=`echo  [*] Desactivando SMBv1...\nPowerShell -Command "Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -NoRestart" >nul 2>&1\n`;
if(T('m_dism'))s+=`echo  [*] DISM RestoreHealth...\nDISM /Online /Cleanup-Image /RestoreHealth\n`;
if(T('m_sfc'))s+=`echo  [*] SFC scannow...\nsfc /scannow\n`;
if(T('m_defrag'))s+=`echo  [*] Optimizando disco...\ndefrag C: /O\n`;
if(T('b_onedrive'))s+=`echo  [*] Sin OneDrive inicio...\nreg delete "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" /v OneDrive /f >nul 2>&1\n`;
if(T('wu_no_restart'))s+=`echo  [*] Sin reinicio auto...\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v NoAutoRebootWithLoggedOnUsers /t REG_DWORD /d 1 /f >nul\n`;
s+=`
echo.
echo  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
echo  ‚ïë  ‚úÖ COMPLETADO                       ‚ïë
echo  ‚ïë  üõ°Ô∏è Defender: INTACTO                ‚ïë
echo  ‚ïë  üìã ${Object.values(S.toggles).filter(v=>v).length} optimizaciones aplicadas       ‚ïë
echo  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
echo.
echo  Se recomienda reiniciar.
echo.
set /p r="  ¬øReiniciar ahora? (S/N): "
if /i "%r%"=="S" shutdown /r /t 10 /c "PCTuner Pro v6"
pause
`;return s;}
function genPS1(){let s=`# PCTuner Pro v6 ‚Äî ${S.hw.brand}\n# Defender: INTACTO\nif(-NOT([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]"Administrator")){Write-Host "[!] Admin" -FG Red;exit}\n`;if(T('m_restore'))s+=`Checkpoint-Computer -Description "PCTuner_v6" -EA SilentlyContinue\n`;if(T('p_sysmain'))s+=`Stop-Service "SysMain" -Force -EA SilentlyContinue;Set-Service "SysMain" -StartupType Disabled\n`;if(T('pr_telemetry'))s+=`Set-ItemProperty "HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" -Name "AllowTelemetry" -Value 0 -Type DWord -Force\n`;if(T('c_temp'))s+=`Remove-Item "$env:TEMP\\*" -Recurse -Force -EA SilentlyContinue\n`;s+=`Write-Host "OK. Defender: NO MODIFICADO" -FG Green\nRead-Host\n`;return s;}
function genREG(){let s=`Windows Registry Editor Version 5.00\n; PCTuner Pro v6 ‚Äî ${S.hw.brand}\n; Defender NO se modifica\n\n`;if(T('v_dark'))s+=`[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize]\n"SystemUsesLightTheme"=dword:00000000\n\n`;if(T('pr_telemetry'))s+=`[HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection]\n"AllowTelemetry"=dword:00000000\n\n`;if(T('e_ext'))s+=`[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced]\n"HideFileExt"=dword:00000000\n\n`;return s;}
function genAHK(){let s=`; PCTuner Pro v6 ‚Äî ${S.hw.brand}\n#Requires AutoHotkey v2.0\n#SingleInstance Force\n\n`;const m={k_screenshot:'Send "{PrintScreen}"',k_taskmgr:'Run "taskmgr.exe"',k_run:'Send "#r"',k_explorer:'Run "explorer.exe"',k_cmd:'Run "*RunAs cmd.exe"',k_desktop:'Send "#d"',k_vol_up:'Send "{Volume_Up}"',k_vol_down:'Send "{Volume_Down}"',k_mute:'Send "{Volume_Mute}"',k_play:'Send "{Media_Play_Pause}"',k_calc:'Run "calc.exe"',k_notepad:'Run "notepad.exe"',k_lock:'DllCall("LockWorkStation")',k_browser:'Run "msedge.exe"'};Object.entries(S.keybinds).forEach(([id,combo])=>{const a=m[id];if(!a)return;let h=combo.replace(/Ctrl/g,'^').replace(/Alt/g,'!').replace(/Shift/g,'+').replace(/Win/g,'#').replace(/ \+ /g,'');h=h.replace(/([A-Z])$/,x=>x.toLowerCase());s+=`${h}:: {\n    ${a}\n}\n\n`;});return s;}

// ==================== SCORE / UTILS ====================
function calcScore(){const a=Object.values(S.toggles).filter(v=>v).length,t=Object.keys(S.toggles).length;if(!t)return 50;return Math.min(99,Math.round(40+a/t*59));}
function updScore(){const s=calcScore(),el=document.getElementById('scoreVal'),ring=document.getElementById('scoreRing');if(el)el.textContent=s;if(ring){const circ=2*Math.PI*14,off=circ-(s/100)*circ;ring.setAttribute('stroke-dashoffset',off);ring.setAttribute('stroke',s>=75?'#10b981':s>=50?'#f59e0b':'#ef4444');}document.getElementById('perfScore')?.classList.remove('hidden');}
function updSB(){const hw=document.getElementById('sbHw'),h=S.hw;if(hw)hw.textContent=h.brand+' ¬∑ '+(h.os||'')+(h.osVer?' '+h.osVer:'')+' ¬∑ '+h.cores+'C'+(h.ram?' ¬∑ '+h.ram+'GB':'');const ch=document.getElementById('sbCh');if(ch)ch.textContent=cCount+' cambios';}
function updClock(){const n=new Date(),el=document.getElementById('clock');if(el)el.textContent=n.getHours().toString().padStart(2,'0')+':'+n.getMinutes().toString().padStart(2,'0')+':'+n.getSeconds().toString().padStart(2,'0');}

// ==================== INIT ====================
async function init(){buildNav();buildSI();await detectHW();updClock();setInterval(updClock,1000);go('dashboard');simMon();setInterval(simMon,3000);updScore();updSB();const l=document.getElementById('loader');if(l){l.classList.add('hide');setTimeout(()=>l.remove(),300);}}
init();
window.addEventListener('resize',()=>{if(S.page==='fans')initFanCanvas();});
</script>
</body>
</html>